<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. &#21021;&#31561;&#25968;&#35770; &mdash; Mathematics in Lean 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=0731ccc3" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=7c91f8fd"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Structures" href="C06_Structures.html" />
    <link rel="prev" title="4. &#38598;&#21512;&#21644;&#20989;&#25968;" href="C04_Sets_and_Functions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Mathematics in Lean
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="C01_Introduction.html">1. &#24341;&#35328;</a></li>
<li class="toctree-l1"><a class="reference internal" href="C02_Basics.html">2. &#22522;&#30784;&#30693;&#35782;</a></li>
<li class="toctree-l1"><a class="reference internal" href="C03_Logic.html">3. &#36923;&#36753;</a></li>
<li class="toctree-l1"><a class="reference internal" href="C04_Sets_and_Functions.html">4. &#38598;&#21512;&#21644;&#20989;&#25968;</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. &#21021;&#31561;&#25968;&#35770;</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#section-irrational-roots">5.1. &#26080;&#29702;&#26681;</a></li>
<li class="toctree-l2"><a class="reference internal" href="#induction-and-recursion">5.2. Induction and Recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#infinitely-many-primes">5.3. Infinitely Many Primes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="C06_Structures.html">6. Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="C07_Hierarchies.html">7. Hierarchies</a></li>
<li class="toctree-l1"><a class="reference internal" href="C08_Groups_and_Rings.html">8. Groups and Rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="C09_Topology.html">9. Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="C10_Differential_Calculus.html">10. Differential Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="C11_Integration_and_Measure_Theory.html">11. Integration and Measure Theory</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mathematics in Lean</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">5. </span>&#21021;&#31561;&#25968;&#35770;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/C05_Elementary_Number_Theory.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="number-theory">
<span id="id1"></span><h1><span class="section-number">5. </span>&#21021;&#31561;&#25968;&#35770;<a class="headerlink" href="#number-theory" title="Link to this heading">&#61633;</a></h1>
<p>&#22312;&#26412;&#31456;&#20013;&#65292;&#25105;&#20204;&#21521;&#20320;&#23637;&#31034;&#22914;&#20309;&#24418;&#24335;&#21270;&#25968;&#35770;&#20013;&#30340;&#19968;&#20123;&#21021;&#31561;&#32467;&#26524;&#12290;
&#24403;&#25105;&#20204;&#22788;&#29702;&#26356;&#23454;&#36136;&#24615;&#30340;&#25968;&#23398;&#20869;&#23481;&#26102;&#65292;
&#35777;&#26126;&#20250;&#21464;&#24471;&#26356;&#38271;&#12289;&#26356;&#22797;&#26434;&#65292;
&#20197;&#20320;&#24050;&#32463;&#25484;&#25569;&#30340;&#25216;&#33021;&#20026;&#22522;&#30784;&#12290;</p>
<section id="section-irrational-roots">
<span id="id2"></span><h2><span class="section-number">5.1. </span>&#26080;&#29702;&#26681;<a class="headerlink" href="#section-irrational-roots" title="Link to this heading">&#61633;</a></h2>
<p>&#35753;&#25105;&#20204;&#20174;&#21476;&#24076;&#33098;&#20154;&#30693;&#36947;&#30340;&#19968;&#20010;&#20107;&#23454;&#24320;&#22987;&#65292;&#21363; 2 &#30340;&#24179;&#26041;&#26681;&#26159;&#26080;&#29702;&#25968;&#12290;
&#22914;&#26524;&#25105;&#20204;&#20551;&#23450;&#24182;&#38750;&#22914;&#27492;&#65292;
&#21017;&#25105;&#20204;&#21487;&#20197;&#23558;&#20854;&#34920;&#31034;&#20026;&#26368;&#31616;&#20998;&#25968; <span class="math notranslate nohighlight">\(\sqrt{2} = a / b\)</span>.
&#20004;&#36793;&#21462;&#24179;&#26041;&#24471;&#21040; <span class="math notranslate nohighlight">\(a^2 = 2 b^2\)</span>,
&#36825;&#24847;&#21619;&#30528; <span class="math notranslate nohighlight">\(a\)</span> &#26159;&#20598;&#25968;&#12290;
&#22914;&#26524;&#25105;&#20204;&#35760; <span class="math notranslate nohighlight">\(a = 2c\)</span>, &#21017;&#26377; <span class="math notranslate nohighlight">\(4c^2 = 2 b^2\)</span>,
&#20174;&#32780; <span class="math notranslate nohighlight">\(b^2 = 2 c^2\)</span>.
&#36825;&#24847;&#21619;&#30528; <span class="math notranslate nohighlight">\(b\)</span> &#20063;&#26159;&#20598;&#25968;&#65292;
&#36825;&#21644;&#25105;&#20204;&#20551;&#35774;&#30340;&#20107;&#23454;&#65292;&#21363; <span class="math notranslate nohighlight">\(a / b\)</span> &#24050;&#32422;&#20998;&#21040;&#26368;&#31616;&#30683;&#30462;&#12290;</p>
<p>&#31216; <span class="math notranslate nohighlight">\(a / b\)</span> &#26159;&#26368;&#31616;&#20998;&#25968;&#24847;&#21619;&#30528; <span class="math notranslate nohighlight">\(a\)</span> &#21644; <span class="math notranslate nohighlight">\(b\)</span> &#27809;&#26377;&#20219;&#20309;&#20844;&#22240;&#23376;&#65292;
&#20063;&#23601;&#26159;&#35828;&#65292;&#23427;&#20204;&#26159; <em>&#20114;&#32032;</em> &#30340;&#12290;
Mathlib &#25226;&#35859;&#35789; <code class="docutils literal notranslate"><span class="pre">Nat.Coprime</span> <span class="pre">m</span> <span class="pre">n</span></code> &#23450;&#20041;&#20026; <code class="docutils literal notranslate"><span class="pre">Nat.gcd</span> <span class="pre">m</span> <span class="pre">n</span> <span class="pre">=</span> <span class="pre">1</span></code>.
&#20351;&#29992; Lean &#30340;&#21311;&#21517;&#25237;&#24433;&#35760;&#21495;&#65292;&#22914;&#26524; <code class="docutils literal notranslate"><span class="pre">s</span></code> &#21644; <code class="docutils literal notranslate"><span class="pre">t</span></code> &#26159; <code class="docutils literal notranslate"><span class="pre">Nat</span></code> &#31867;&#22411;&#30340;&#34920;&#36798;&#24335;&#65292;
&#25105;&#20204;&#21487;&#20197;&#29992; <code class="docutils literal notranslate"><span class="pre">s.Coprime</span> <span class="pre">t</span></code> &#26367;&#20195; <code class="docutils literal notranslate"><span class="pre">Nat.Coprime</span> <span class="pre">s</span> <span class="pre">t</span></code>,
&#32780; <code class="docutils literal notranslate"><span class="pre">Nat.gcd</span></code> &#20063;&#26377;&#31867;&#20284;&#30340;&#34920;&#36798;&#26041;&#24335;&#12290;
&#20687;&#24448;&#24120;&#19968;&#26679;&#65292;Lean &#36890;&#24120;&#20250;&#22312;&#24517;&#35201;&#26102;&#33258;&#21160;&#23637;&#24320; <code class="docutils literal notranslate"><span class="pre">Nat.Coprime</span></code> &#30340;&#23450;&#20041;&#65292;
&#20294;&#25105;&#20204;&#20063;&#21487;&#20197;&#36890;&#36807;&#37325;&#20889;&#25110;&#31616;&#21270;&#26631;&#35782;&#31526; <code class="docutils literal notranslate"><span class="pre">Nat.Coprime</span></code> &#26469;&#25163;&#21160;&#25805;&#20316;&#12290;
<code class="docutils literal notranslate"><span class="pre">norm_num</span></code> &#31574;&#30053;&#36275;&#22815;&#26234;&#33021;&#65292;&#21487;&#20197;&#35745;&#31639;&#20855;&#20307;&#20540;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="k">#print</span> <span class="n">Nat.Coprime</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m.Coprime</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">m.gcd</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
  <span class="n">h</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m.Coprime</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">m.gcd</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.Coprime</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span>
  <span class="n">exact</span> <span class="n">h</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">Nat.Coprime</span> <span class="mi">12</span> <span class="mi">7</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">Nat.gcd</span> <span class="mi">12</span> <span class="mi">8</span> <span class="bp">=</span> <span class="mi">4</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>
</pre></div>
</div>
<p>&#25105;&#20204;&#24050;&#32463;&#22312; <a class="reference internal" href="C02_Basics.html#more-on-order-and-divisibility"><span class="std std-numref">Section 2.4</span></a> &#20013;&#36935;&#21040;&#36807; <code class="docutils literal notranslate"><span class="pre">gcd</span></code> &#20989;&#25968;&#12290;
&#36824;&#26377;&#19968;&#20010;&#29992;&#20110;&#25972;&#25968;&#30340; <code class="docutils literal notranslate"><span class="pre">gcd</span></code> &#29256;&#26412;&#65307;
&#25105;&#20204;&#23558;&#22312;&#19979;&#38754;&#22238;&#21040;&#19981;&#21516;&#25968;&#31995;&#20043;&#38388;&#20851;&#31995;&#30340;&#35752;&#35770;&#20013;&#12290;
&#29978;&#33267;&#36824;&#26377;&#24191;&#20041; <code class="docutils literal notranslate"><span class="pre">gcd</span></code> &#20989;&#25968;&#20197;&#21450;&#24191;&#20041; <code class="docutils literal notranslate"><span class="pre">Prime</span></code> &#21644; <code class="docutils literal notranslate"><span class="pre">Coprime</span></code> &#30340;&#27010;&#24565;&#65292;
&#23427;&#20204;&#22312;&#19968;&#33324;&#31867;&#22411;&#30340;&#20195;&#25968;&#32467;&#26500;&#20013;&#26377;&#24847;&#20041;&#12290;
&#25105;&#20204;&#23558;&#22312;&#19979;&#19968;&#31456;&#20102;&#35299; Lean &#26159;&#22914;&#20309;&#31649;&#29702;&#36825;&#31181;&#19968;&#33324;&#24615;&#30340;&#12290;
&#21516;&#26102;&#65292;&#22312;&#26412;&#33410;&#20013;&#65292;&#25105;&#20204;&#23558;&#25226;&#27880;&#24847;&#21147;&#38480;&#21046;&#21040;&#33258;&#28982;&#25968;&#12290;</p>
<p>&#25105;&#20204;&#36824;&#38656;&#35201;&#32032;&#25968;&#30340;&#27010;&#24565;&#65292; <code class="docutils literal notranslate"><span class="pre">Nat.Prime</span></code>.
&#23450;&#29702; <code class="docutils literal notranslate"><span class="pre">Nat.prime_def_lt</span></code> &#25552;&#20379;&#20102;&#19968;&#20010;&#29087;&#24713;&#30340;&#21051;&#30011;&#65292;
<code class="docutils literal notranslate"><span class="pre">Nat.Prime.eq_one_or_self_of_dvd</span></code> &#25552;&#20379;&#20102;&#21478;&#19968;&#20010;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="k">#check</span> <span class="n">Nat.prime_def_lt</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">Nat.Prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">p</span> <span class="bp">&#8743;</span> <span class="bp">&#8704;</span> <span class="n">m</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">,</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">p</span> <span class="bp">&#8594;</span> <span class="n">m</span> <span class="bp">&#8739;</span> <span class="n">p</span> <span class="bp">&#8594;</span> <span class="n">m</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rwa</span> <span class="o">[</span><span class="n">Nat.prime_def_lt</span><span class="o">]</span> <span class="n">at</span> <span class="n">prime_p</span>

<span class="k">#check</span> <span class="n">Nat.Prime.eq_one_or_self_of_dvd</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">Nat.Prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8704;</span> <span class="n">m</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">,</span> <span class="n">m</span> <span class="bp">&#8739;</span> <span class="n">p</span> <span class="bp">&#8594;</span> <span class="n">m</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">&#8744;</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">p</span> <span class="o">:=</span>
  <span class="n">prime_p.eq_one_or_self_of_dvd</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">Nat.Prime</span> <span class="mi">17</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="c1">-- commonly used</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">Nat.Prime</span> <span class="mi">2</span> <span class="o">:=</span>
  <span class="n">Nat.prime_two</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">Nat.Prime</span> <span class="mi">3</span> <span class="o">:=</span>
  <span class="n">Nat.prime_three</span>
</pre></div>
</div>
<p>&#22312;&#33258;&#28982;&#25968;&#20013;&#65292;&#32032;&#25968;&#20855;&#26377;&#19981;&#33021;&#20889;&#25104;&#38750;&#24179;&#20961;&#22240;&#23376;&#30340;&#20056;&#31215;&#30340;&#24615;&#36136;&#12290;
&#22312;&#26356;&#24191;&#27867;&#30340;&#25968;&#23398;&#32972;&#26223;&#19979;&#65292;&#29615;&#20013;&#20855;&#26377;&#27492;&#24615;&#36136;&#30340;&#20803;&#32032;&#34987;&#31216;&#20026; <em>&#19981;&#21487;&#32422;</em> &#30340;&#12290;
&#29615;&#30340;&#20803;&#32032;&#31216;&#20026; <em>&#32032;&#20803;</em>&#65292;&#22914;&#26524;&#27599;&#24403;&#23427;&#25972;&#38500;&#19968;&#20010;&#20056;&#31215;&#26102;&#65292;&#23427;&#25972;&#38500;&#20854;&#20013;&#19968;&#20010;&#22240;&#23376;&#12290;
&#33258;&#28982;&#25968;&#30340;&#19968;&#20010;&#37325;&#35201;&#24615;&#36136;&#26159;&#65292;&#23545;&#23427;&#26469;&#35828;&#36825;&#20004;&#20010;&#27010;&#24565;&#26159;&#19968;&#33268;&#30340;&#65292;
&#36825;&#20135;&#29983;&#20102;&#23450;&#29702; <code class="docutils literal notranslate"><span class="pre">Nat.Prime.dvd_mul</span></code>.</p>
<p>&#25105;&#20204;&#21487;&#20197;&#21033;&#29992;&#36825;&#20010;&#20107;&#23454;&#24314;&#31435;&#19978;&#38754;&#35770;&#35777;&#20013;&#30340;&#19968;&#20010;&#20851;&#38190;&#24615;&#36136;&#65306;
&#22914;&#26524;&#19968;&#20010;&#25968;&#30340;&#24179;&#26041;&#26159;&#20598;&#25968;&#65292;&#37027;&#20040;&#36825;&#20010;&#25968;&#20063;&#26159;&#20598;&#25968;&#12290;
Mathlib &#22312; <code class="docutils literal notranslate"><span class="pre">Data.Nat.Parity</span></code> &#20013;&#23450;&#20041;&#20102;&#35859;&#35789; <code class="docutils literal notranslate"><span class="pre">Even</span></code>,
&#20294;&#20986;&#20110;&#19979;&#38754;&#20250;&#28548;&#28165;&#30340;&#21407;&#22240;&#65292;
&#25105;&#20204;&#23558;&#31616;&#21333;&#22320;&#29992; <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">&#8739;</span> <span class="pre">m</span></code> &#34920;&#31034; <code class="docutils literal notranslate"><span class="pre">m</span></code> &#26159;&#20598;&#25968;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="k">#check</span> <span class="n">Nat.Prime.dvd_mul</span>
<span class="k">#check</span> <span class="n">Nat.Prime.dvd_mul</span> <span class="n">Nat.prime_two</span>
<span class="k">#check</span> <span class="n">Nat.prime_two.dvd_mul</span>

<span class="kd">theorem</span> <span class="n">even_of_even_sqr</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">pow_two</span><span class="o">,</span> <span class="n">Nat.prime_two.dvd_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="n">m</span> <span class="o">:=</span>
  <span class="n">Nat.Prime.dvd_of_dvd_pow</span> <span class="n">Nat.prime_two</span> <span class="n">h</span>
</pre></div>
</div>
<p>&#38543;&#30528;&#25105;&#20204;&#30340;&#32487;&#32493;&#65292;&#20320;&#23558;&#38656;&#35201;&#29087;&#32451;&#22320;&#26597;&#25214;&#25152;&#38656;&#30340;&#20107;&#23454;&#12290;
&#35831;&#35760;&#20303;&#65292;&#22914;&#26524;&#20320;&#33021;&#29468;&#20986;&#21517;&#31216;&#30340;&#21069;&#32512;&#24182;&#19988;&#20320;&#24050;&#32463;&#23548;&#20837;&#20102;&#30456;&#20851;&#24211;&#65292;
&#20320;&#21487;&#20197;&#20351;&#29992;&#21046;&#34920;&#31526;&#34917;&#20840;&#65288;&#26377;&#26102;&#20351;&#29992; <code class="docutils literal notranslate"><span class="pre">ctrl-tab</span></code>&#65289;&#26469;&#26597;&#25214;&#20320;&#22312;&#23547;&#25214;&#30340;&#19996;&#35199;&#12290;
&#20320;&#21487;&#20197;&#22312;&#20219;&#20309;&#26631;&#35782;&#31526;&#19978;&#20351;&#29992; <code class="docutils literal notranslate"><span class="pre">ctrl-click</span></code> &#26469;&#36339;&#36716;&#21040;&#25991;&#20214;&#20013;&#23427;&#30340;&#23450;&#20041;&#25152;&#22312;&#20301;&#32622;&#65292;
&#20351;&#20320;&#33021;&#22815;&#27983;&#35272;&#38468;&#36817;&#30340;&#23450;&#20041;&#21644;&#23450;&#29702;&#12290;
&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;
<a class="reference external" href="https://leanprover-community.github.io/">Lean community web pages</a>
&#37324;&#30340;&#25628;&#32034;&#24341;&#25806;&#65292;
&#22914;&#26524;&#20854;&#20182;&#26041;&#27861;&#37117;&#22833;&#36133;&#20102;&#65292;
&#19981;&#35201;&#32670;&#20110;&#21521;
<a class="reference external" href="https://leanprover.zulipchat.com/">Zulip</a>
&#25552;&#38382;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">h&#39;</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">c</span> <span class="o">:=</span>
  <span class="c1">-- apply? suggests the following:</span>
  <span class="o">(</span><span class="n">mul_right_inj&#39;</span> <span class="n">h&#39;</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">h</span>
</pre></div>
</div>
<p>&#25105;&#20204;&#23545;&#26681;&#21495;&#20108;&#26080;&#29702;&#24615;&#35777;&#26126;&#30340;&#26680;&#24515;&#21253;&#21547;&#22312;&#19979;&#21015;&#23450;&#29702;&#20013;&#12290;
&#30475;&#30475;&#20320;&#33021;&#19981;&#33021;&#22635;&#34917;&#36825;&#20010;&#35777;&#26126;&#26775;&#27010;&#65292;
&#35831;&#20351;&#29992; <code class="docutils literal notranslate"><span class="pre">even_of_even_sqr</span></code> &#20197;&#21450;&#23450;&#29702; <code class="docutils literal notranslate"><span class="pre">Nat.dvd_gcd</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">coprime_mn</span> <span class="o">:</span> <span class="n">m.Coprime</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">&#8800;</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">intro</span> <span class="n">sqr_eq</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="n">obtain</span> <span class="o">&#10216;</span><span class="n">k</span><span class="o">,</span> <span class="n">meq</span><span class="o">&#10217;</span> <span class="o">:=</span> <span class="n">dvd_iff_exists_eq_mul_left.mp</span> <span class="n">this</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">k</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">&#8592;</span> <span class="n">sqr_eq</span><span class="o">,</span> <span class="n">meq</span><span class="o">]</span>
    <span class="n">ring</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">k</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="n">m.gcd</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8739;</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="n">norm_num</span> <span class="n">at</span> <span class="n">this</span>
</pre></div>
</div>
<p>&#20107;&#23454;&#19978;&#65292;&#21482;&#38656;&#24456;&#23569;&#30340;&#25913;&#21464;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#25226; <code class="docutils literal notranslate"><span class="pre">2</span></code> &#26367;&#25442;&#20026;&#20219;&#24847;&#32032;&#25968;&#12290;
&#22312;&#19979;&#19968;&#20010;&#20363;&#23376;&#20013;&#35797;&#19968;&#35797;&#12290;
&#22312;&#35777;&#26126;&#30340;&#26411;&#23614;&#65292;&#20320;&#38656;&#35201;&#30001; <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&#8739;</span> <span class="pre">1</span></code> &#23548;&#20986;&#30683;&#30462;&#12290;
&#20320;&#21487;&#20197;&#20351;&#29992; <code class="docutils literal notranslate"><span class="pre">Nat.Prime.two_le</span></code>,
&#23427;&#26159;&#35828;&#20219;&#24847;&#32032;&#25968;&#22823;&#20110;&#25110;&#31561;&#20110;&#20108;&#65292;
&#20197;&#21450; <code class="docutils literal notranslate"><span class="pre">Nat.le_of_dvd</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">coprime_mn</span> <span class="o">:</span> <span class="n">m.Coprime</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">p.Prime</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">&#8800;</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>&#25105;&#20204;&#32771;&#34385;&#21478;&#19968;&#31181;&#24605;&#36335;&#12290;
&#36825;&#26159;&#33509; <span class="math notranslate nohighlight">\(p\)</span> &#26159;&#32032;&#25968;&#21017; <span class="math notranslate nohighlight">\(m^2 \ne p n^2\)</span> &#30340;&#19968;&#20010;&#24555;&#36895;&#35777;&#26126;&#65306;
&#22914;&#26524;&#25105;&#20204;&#20551;&#35774; <span class="math notranslate nohighlight">\(m^2 = p n^2\)</span>,
&#32771;&#34385; <span class="math notranslate nohighlight">\(m\)</span> &#21644; <span class="math notranslate nohighlight">\(n\)</span> &#30340;&#32032;&#20998;&#35299;&#65292;
&#21017; <span class="math notranslate nohighlight">\(p\)</span> &#22312;&#31561;&#24335;&#24038;&#36793;&#20986;&#29616;&#20598;&#25968;&#27425;&#32780;&#22312;&#21491;&#36793;&#20986;&#29616;&#22855;&#25968;&#27425;&#65292;&#30683;&#30462;&#12290;
&#27880;&#24847;&#21040;&#36825;&#20010;&#35770;&#35777;&#35201;&#27714; <span class="math notranslate nohighlight">\(n\)</span>, &#20174;&#32780; <span class="math notranslate nohighlight">\(m\)</span>,
&#19981;&#31561;&#20110;&#38646;&#12290;
&#19979;&#38754;&#30340;&#24418;&#24335;&#21270;&#35777;&#23454;&#20102;&#36825;&#20010;&#20551;&#35774;&#26159;&#20805;&#20998;&#30340;&#12290;</p>
<p>&#21807;&#19968;&#22240;&#23376;&#20998;&#35299;&#23450;&#29702;&#34920;&#26126;&#65292;
&#20219;&#20309;&#22823;&#20110;&#38646;&#30340;&#33258;&#28982;&#25968;&#21487;&#20197;&#29992;&#21807;&#19968;&#30340;&#26041;&#24335;&#20889;&#25104;&#32032;&#25968;&#30340;&#20056;&#31215;&#12290;
Mathlib &#21253;&#21547;&#20854;&#24418;&#24335;&#21270;&#29256;&#26412;&#65292;&#20351;&#29992;&#20989;&#25968; <code class="docutils literal notranslate"><span class="pre">Nat.factors</span></code> &#34920;&#36798;&#65292;
&#35813;&#20989;&#25968;&#20197;&#38750;&#36882;&#20943;&#39034;&#24207;&#36820;&#22238;&#25968;&#30340;&#32032;&#22240;&#25968;&#21015;&#34920;&#12290;
&#27492;&#24211;&#35777;&#26126;&#20102; <code class="docutils literal notranslate"><span class="pre">Nat.factors</span> <span class="pre">n</span></code> &#30340;&#20840;&#37096;&#20803;&#32032;&#37117;&#26159;&#32032;&#25968;&#65292;
&#20219;&#24847;&#22823;&#20110;&#38646;&#30340; <code class="docutils literal notranslate"><span class="pre">n</span></code> &#31561;&#20110;&#23427;&#30340;&#22240;&#23376;&#30340;&#20056;&#31215;&#65292;
&#20197;&#21450;&#33509; <code class="docutils literal notranslate"><span class="pre">n</span></code> &#31561;&#20110;&#21478;&#19968;&#21015;&#32032;&#25968;&#30340;&#20056;&#31215;&#65292;
&#21017;&#36825;&#20010;&#21015;&#26159; <code class="docutils literal notranslate"><span class="pre">Nat.factors</span> <span class="pre">n</span></code> &#30340;&#19968;&#20010;&#25490;&#21015;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="k">#check</span> <span class="n">Nat.factors</span>
<span class="k">#check</span> <span class="n">Nat.prime_of_mem_factors</span>
<span class="k">#check</span> <span class="n">Nat.prod_factors</span>
<span class="k">#check</span> <span class="n">Nat.factors_unique</span>
</pre></div>
</div>
<p>&#20320;&#21487;&#20197;&#27983;&#35272;&#36825;&#20123;&#23450;&#29702;&#21644;&#38468;&#36817;&#30340;&#20854;&#20182;&#23450;&#29702;&#65292;
&#21363;&#20351;&#25105;&#20204;&#36824;&#27809;&#26377;&#35848;&#21040;&#21015;&#34920;&#25104;&#21592;&#12289;&#20056;&#31215;&#25110;&#25490;&#21015;&#12290;
&#25105;&#20204;&#25163;&#22836;&#30340;&#20219;&#21153;&#19981;&#38656;&#35201;&#36825;&#20123;&#12290;
&#25105;&#20204;&#20250;&#20351;&#29992; Mathlib &#20989;&#25968; <code class="docutils literal notranslate"><span class="pre">Nat.factorization</span></code> &#20316;&#20026;&#26367;&#20195;&#21697;&#65292;
&#23427;&#25226;&#21516;&#26679;&#30340;&#25968;&#25454;&#34920;&#31034;&#20026;&#20989;&#25968;&#12290;
&#29305;&#21035;&#22320;&#65292;<code class="docutils literal notranslate"><span class="pre">Nat.factorization</span> <span class="pre">n</span> <span class="pre">p</span></code>,
&#20063;&#35760;&#20026; <code class="docutils literal notranslate"><span class="pre">n.factorization</span> <span class="pre">p</span></code>,
&#36820;&#22238; <code class="docutils literal notranslate"><span class="pre">n</span></code> &#30340;&#32032;&#20998;&#35299;&#20013; <code class="docutils literal notranslate"><span class="pre">p</span></code> &#30340;&#37325;&#25968;&#12290;
&#25105;&#20204;&#23558;&#29992;&#21040;&#20197;&#19979;&#19977;&#20010;&#20107;&#23454;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">factorization_mul&#39;</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">mnez</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">nnez</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="n">m</span> <span class="bp">*</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">factorization</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">m.factorization</span> <span class="n">p</span> <span class="bp">+</span> <span class="n">n.factorization</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.factorization_mul</span> <span class="n">mnez</span> <span class="n">nnez</span><span class="o">]</span>
  <span class="n">rfl</span>

<span class="kd">theorem</span> <span class="n">factorization_pow&#39;</span> <span class="o">(</span><span class="n">n</span> <span class="n">k</span> <span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="n">n</span> <span class="bp">^</span> <span class="n">k</span><span class="o">)</span><span class="bp">.</span><span class="n">factorization</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">k</span> <span class="bp">*</span> <span class="n">n.factorization</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.factorization_pow</span><span class="o">]</span>
  <span class="n">rfl</span>

<span class="kd">theorem</span> <span class="n">Nat.Prime.factorization&#39;</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">p.Prime</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">p.factorization</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">prime_p.factorization</span><span class="o">]</span>
  <span class="n">simp</span>
</pre></div>
</div>
<p>&#20107;&#23454;&#19978;&#65292;<code class="docutils literal notranslate"><span class="pre">n.factorization</span></code> &#22312; Lean &#20013;&#34987;&#23450;&#20041;&#20026;&#26377;&#38480;&#25903;&#38598;&#30340;&#20989;&#25968;&#65292;
&#36825;&#35299;&#37322;&#20102;&#20320;&#22312;&#36880;&#27493;&#26597;&#30475;&#19978;&#36848;&#35777;&#26126;&#26102;&#20250;&#30475;&#21040;&#30340;&#22855;&#24618;&#31526;&#21495;&#12290;
&#29616;&#22312;&#19981;&#29992;&#25285;&#24515;&#36825;&#20010;&#12290;
&#20986;&#20110;&#25105;&#20204;&#36825;&#37324;&#30340;&#30446;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#23558;&#19978;&#38754;&#19977;&#20010;&#23450;&#29702;&#20316;&#20026;&#40657;&#30418;&#20351;&#29992;&#12290;</p>
<p>&#19979;&#19968;&#20010;&#31034;&#20363;&#34920;&#26126;&#21270;&#31616;&#22120;&#36275;&#22815;&#26234;&#33021;&#65292;
&#21487;&#20197;&#25226; <code class="docutils literal notranslate"><span class="pre">n^2</span> <span class="pre">&#8800;</span> <span class="pre">0</span></code> &#26367;&#25442;&#20026; <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&#8800;</span> <span class="pre">0</span></code>.
&#31574;&#30053; <code class="docutils literal notranslate"><span class="pre">simpa</span></code> &#19981;&#36807;&#26159;&#20808;&#35843;&#29992; <code class="docutils literal notranslate"><span class="pre">simp</span></code> &#25509;&#19979;&#26469;&#29992; <code class="docutils literal notranslate"><span class="pre">assumption</span></code>.</p>
<p>&#30475;&#30475;&#20320;&#26159;&#21542;&#21487;&#20197;&#29992;&#19978;&#38754;&#30340;&#31561;&#24335;&#26469;&#22635;&#34917;&#35777;&#26126;&#32570;&#22833;&#30340;&#37096;&#20998;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">nnz</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">p.Prime</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">&#8800;</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">intro</span> <span class="n">sqr_eq</span>
  <span class="k">have</span> <span class="n">nsqr_nez</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">&#8800;</span> <span class="mi">0</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simpa</span>
  <span class="k">have</span> <span class="n">eq1</span> <span class="o">:</span> <span class="n">Nat.factorization</span> <span class="o">(</span><span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">m.factorization</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="n">eq2</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">factorization</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">n.factorization</span> <span class="n">p</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">m.factorization</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">n.factorization</span> <span class="n">p</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">%</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">&#8592;</span> <span class="n">eq1</span><span class="o">,</span> <span class="n">sqr_eq</span><span class="o">,</span> <span class="n">eq2</span><span class="o">]</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">add_comm</span><span class="o">,</span> <span class="n">Nat.add_mul_mod_self_left</span><span class="o">,</span> <span class="n">Nat.mul_mod_right</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span>
  <span class="n">norm_num</span> <span class="n">at</span> <span class="n">this</span>
</pre></div>
</div>
<p>&#36825;&#20010;&#35777;&#26126;&#30340;&#19968;&#20010;&#22909;&#22788;&#26159;&#23427;&#30340;&#21487;&#25512;&#24191;&#24615;&#12290;
<code class="docutils literal notranslate"><span class="pre">2</span></code> &#27809;&#20160;&#20040;&#29305;&#21035;&#30340;&#65307;&#36890;&#36807;&#23569;&#37327;&#20462;&#25913;&#65292;
&#35777;&#26126;&#25351;&#20986;&#21482;&#35201;&#25105;&#20204;&#26377; <code class="docutils literal notranslate"><span class="pre">m^k</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">n^k</span></code>,
<code class="docutils literal notranslate"><span class="pre">r</span></code> &#20013;&#32032;&#25968; <code class="docutils literal notranslate"><span class="pre">p</span></code> &#30340;&#37325;&#25968;&#23601;&#21482;&#33021;&#26159; <code class="docutils literal notranslate"><span class="pre">k</span></code> &#30340;&#20493;&#25968;&#12290;</p>
<p>&#20026;&#20102;&#23545; <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">*</span> <span class="pre">n^k</span></code> &#20351;&#29992; <code class="docutils literal notranslate"><span class="pre">Nat.count_factors_mul_of_pos</span></code>,
&#25105;&#20204;&#38656;&#35201;&#30693;&#36947; <code class="docutils literal notranslate"><span class="pre">r</span></code> &#26159;&#27491;&#30340;&#12290;
&#20294;&#24403; <code class="docutils literal notranslate"><span class="pre">r</span></code> &#26159;&#38646;&#26102;&#65292;&#19979;&#38754;&#30340;&#23450;&#29702;&#26159;&#24179;&#20961;&#30340;&#65292;
&#21487;&#20351;&#29992;&#21270;&#31616;&#22120;&#36731;&#26131;&#35777;&#26126;&#12290;
&#25152;&#20197;&#35777;&#26126;&#26159;&#20998;&#24773;&#20917;&#36827;&#34892;&#30340;&#12290;
<code class="docutils literal notranslate"><span class="pre">cases</span> <span class="pre">r</span> <span class="pre">with</span> <span class="pre">r</span></code> &#36825;&#19968;&#34892;&#25226;&#30446;&#26631;&#26367;&#25442;&#20026;&#20004;&#20010;&#29256;&#26412;&#65306;
&#19968;&#20010;&#25226; <code class="docutils literal notranslate"><span class="pre">r</span></code> &#26367;&#25442;&#20026; <code class="docutils literal notranslate"><span class="pre">0</span></code>,
&#21478;&#19968;&#20010;&#25226; <code class="docutils literal notranslate"><span class="pre">r</span></code> &#26367;&#25442;&#20026; <code class="docutils literal notranslate"><span class="pre">r</span></code> &#30340;&#21518;&#32487; <code class="docutils literal notranslate"><span class="pre">r.succ</span></code>.
&#22312;&#31532;&#20108;&#31181;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#21487;&#20197;&#24212;&#29992;&#23450;&#29702; <code class="docutils literal notranslate"><span class="pre">r.succ_ne_zero</span></code>,
&#30001;&#23427;&#21487;&#24471; <code class="docutils literal notranslate"><span class="pre">r.succ</span> <span class="pre">&#8800;</span> <span class="pre">0</span></code>.</p>
<p>&#21478;&#35831;&#27880;&#24847;&#65292;&#20197; <code class="docutils literal notranslate"><span class="pre">have</span> <span class="pre">:</span> <span class="pre">npow_nz</span></code> &#24320;&#22836;&#30340;&#34892;&#25552;&#20379;&#20102; <code class="docutils literal notranslate"><span class="pre">n^k</span> <span class="pre">&#8800;</span> <span class="pre">0</span></code> &#30340;&#31616;&#30701;&#35777;&#26126;&#39033;&#35777;&#26126;&#12290;
&#35201;&#29702;&#35299;&#23427;&#26159;&#22914;&#20309;&#24037;&#20316;&#30340;&#65292;&#35831;&#23581;&#35797;&#29992;&#31574;&#30053;&#35777;&#26126;&#26367;&#25442;&#23427;&#65292;
&#28982;&#21518;&#24605;&#32771;&#31574;&#30053;&#22914;&#20309;&#25551;&#36848;&#35777;&#26126;&#39033;&#12290;</p>
<p>&#30475;&#30475;&#20320;&#26159;&#21542;&#21487;&#20197;&#22635;&#34917;&#19979;&#21015;&#35777;&#26126;&#20013;&#32570;&#22833;&#30340;&#37096;&#20998;&#12290;
&#22312;&#26368;&#21518;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992; <code class="docutils literal notranslate"><span class="pre">Nat.dvd_sub'</span></code> &#21644; <code class="docutils literal notranslate"><span class="pre">Nat.dvd_mul_right</span></code> &#26469;&#25910;&#23614;&#12290;</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="n">k</span> <span class="n">r</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">nnz</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">pow_eq</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">=</span> <span class="n">r</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">^</span> <span class="n">k</span><span class="o">)</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">p.Prime</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">k</span> <span class="bp">&#8739;</span> <span class="n">r.factorization</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rcases</span> <span class="n">r</span> <span class="k">with</span> <span class="n">_</span> <span class="bp">|</span> <span class="n">r</span>
  <span class="bp">&#183;</span> <span class="n">simp</span>
  <span class="k">have</span> <span class="n">npow_nz</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">&#8800;</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">fun</span> <span class="n">npowz</span> <span class="bp">&#8614;</span> <span class="n">nnz</span> <span class="o">(</span><span class="n">pow_eq_zero</span> <span class="n">npowz</span><span class="o">)</span>
  <span class="k">have</span> <span class="n">eq1</span> <span class="o">:</span> <span class="o">(</span><span class="n">m</span> <span class="bp">^</span> <span class="n">k</span><span class="o">)</span><span class="bp">.</span><span class="n">factorization</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">k</span> <span class="bp">*</span> <span class="n">m.factorization</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="n">eq2</span> <span class="o">:</span> <span class="o">(</span><span class="n">r.succ</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">^</span> <span class="n">k</span><span class="o">)</span><span class="bp">.</span><span class="n">factorization</span> <span class="n">p</span> <span class="bp">=</span>
      <span class="n">k</span> <span class="bp">*</span> <span class="n">n.factorization</span> <span class="n">p</span> <span class="bp">+</span> <span class="n">r.succ.factorization</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">r.succ.factorization</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">k</span> <span class="bp">*</span> <span class="n">m.factorization</span> <span class="n">p</span> <span class="bp">-</span> <span class="n">k</span> <span class="bp">*</span> <span class="n">n.factorization</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">&#8592;</span> <span class="n">eq1</span><span class="o">,</span> <span class="n">pow_eq</span><span class="o">,</span> <span class="n">eq2</span><span class="o">,</span> <span class="n">add_comm</span><span class="o">,</span> <span class="n">Nat.add_sub_cancel</span><span class="o">]</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">this</span><span class="o">]</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>&#25105;&#20204;&#21487;&#33021;&#24076;&#26395;&#36890;&#36807;&#22810;&#31181;&#26041;&#24335;&#26469;&#25913;&#36827;&#36825;&#20123;&#32467;&#26524;&#12290;
&#39318;&#20808;&#65292;&#26681;&#21495;&#20108;&#26159;&#26080;&#29702;&#25968;&#30340;&#35777;&#26126;&#24212;&#35813;&#28041;&#21450;&#19968;&#20123;&#21644;&#26681;&#21495;&#20108;&#30456;&#20851;&#30340;&#32467;&#35770;&#65292;
&#31216;&#23427;&#26159;&#26080;&#29702;&#25968;&#24212;&#35813;&#25552;&#21040;&#19968;&#20123;&#20851;&#20110;&#26377;&#29702;&#25968;&#30340;&#20107;&#24773;&#65292;&#21363;&#27809;&#26377;&#26377;&#29702;&#25968;&#31561;&#20110;&#23427;&#12290;
&#27492;&#22806;&#65292;&#25105;&#20204;&#24212;&#35813;&#23558;&#26412;&#33410;&#20013;&#30340;&#23450;&#29702;&#25193;&#23637;&#21040;&#25972;&#25968;&#12290;
&#34429;&#28982;&#25968;&#23398;&#19978;&#26174;&#32780;&#26131;&#35265;&#30340;&#26159;&#65292;&#22914;&#26524;&#25105;&#20204;&#21487;&#20197;&#23558;&#20108;&#30340;&#24179;&#26041;&#26681;&#20889;&#20026;&#20004;&#20010;&#25972;&#25968;&#30340;&#21830;&#65292;
&#37027;&#20040;&#25105;&#20204;&#23601;&#21487;&#20197;&#23558;&#20854;&#20889;&#20026;&#20004;&#20010;&#33258;&#28982;&#25968;&#30340;&#21830;&#65292;
&#20294;&#24418;&#24335;&#19978;&#35777;&#26126;&#36825;&#19968;&#28857;&#38656;&#35201;&#19968;&#20123;&#21162;&#21147;&#12290;</p>
<p>&#22312; Mathlib &#20013;&#65292;&#33258;&#28982;&#25968;&#12289;&#25972;&#25968;&#12289;&#26377;&#29702;&#25968;&#12289;&#23454;&#25968;&#21644;&#22797;&#25968;&#29992;&#19981;&#21516;&#30340;&#25968;&#25454;&#31867;&#22411;&#34920;&#31034;&#12290;
&#25226;&#27880;&#24847;&#21147;&#38480;&#21046;&#22312;&#21333;&#29420;&#30340;&#39046;&#22495;&#20013;&#24120;&#24120;&#26159;&#26377;&#24110;&#21161;&#30340;&#65306;
&#25105;&#20204;&#23558;&#30475;&#21040;&#22312;&#33258;&#28982;&#25968;&#19978;&#20570;&#24402;&#32435;&#27861;&#23481;&#26131;&#65292;
&#28041;&#21450;&#25972;&#25968;&#30340;&#25972;&#38500;&#24615;&#30340;&#25512;&#29702;&#20063;&#24456;&#23481;&#26131;&#65292;
&#20294;&#23454;&#25968;&#23601;&#19981;&#22312;&#36825;&#20123;&#22270;&#26223;&#20013;&#12290;
&#20294;&#24517;&#39035;&#22312;&#19981;&#21516;&#39046;&#22495;&#20013;&#36827;&#34892;&#21327;&#35843;&#26159;&#25105;&#20204;&#23558;&#19981;&#24471;&#19981;&#38754;&#23545;&#30340;&#19968;&#20010;&#20196;&#20154;&#22836;&#30140;&#30340;&#38382;&#39064;&#12290;
&#25105;&#20204;&#23558;&#22312;&#26412;&#31456;&#21518;&#38754;&#22238;&#21040;&#36825;&#20010;&#38382;&#39064;&#12290;</p>
<p>&#25105;&#20204;&#36824;&#24212;&#35813;&#26399;&#26395;&#33021;&#25226;&#19978;&#19968;&#20010;&#23450;&#29702;&#30340;&#32467;&#35770;&#21152;&#24378;&#20026;&#25968; <code class="docutils literal notranslate"><span class="pre">r</span></code> &#26159; <code class="docutils literal notranslate"><span class="pre">k</span></code> &#27425;&#24130;&#65292;
&#22240;&#20026;&#23427;&#30340; <code class="docutils literal notranslate"><span class="pre">k</span></code> &#27425;&#26681;&#24688;&#22909;&#26159;&#27599;&#20010;&#25972;&#38500; <code class="docutils literal notranslate"><span class="pre">r</span></code> &#30340;&#32032;&#25968;&#20197;
<code class="docutils literal notranslate"><span class="pre">r</span></code> &#38500;&#20197; <code class="docutils literal notranslate"><span class="pre">k</span></code> &#30340;&#37325;&#25968;&#20026;&#24130;&#27425;&#30340;&#24130;&#30340;&#20056;&#31215;&#12290;
&#20026;&#20102;&#33021;&#22815;&#20570;&#21040;&#36825;&#19968;&#28857;&#65292;
&#25105;&#20204;&#38656;&#35201;&#26356;&#22909;&#30340;&#26041;&#27861;&#26469;&#20570;&#20851;&#20110;&#26377;&#38480;&#38598;&#21512;&#19978;&#30340;&#20056;&#31215;&#19982;&#21644;&#30340;&#25512;&#29702;&#65292;
&#36825;&#20063;&#26159;&#25105;&#20204;&#23558;&#35201;&#22238;&#21040;&#30340;&#35805;&#39064;&#12290;</p>
<p>&#20107;&#23454;&#19978;&#65292;&#26412;&#33410;&#20013;&#30340;&#32467;&#26524;&#37117;&#24050;&#32463;&#22312; Mathlib &#30340;
<code class="docutils literal notranslate"><span class="pre">Data.Real.Irrational</span></code> &#20013;&#20197;&#36828;&#20026;&#24191;&#20041;&#30340;&#26041;&#24335;&#24314;&#31435;&#12290;
<code class="docutils literal notranslate"><span class="pre">multiplicity</span></code> &#30340;&#27010;&#24565;&#22312;&#20219;&#24847;&#30340;&#20132;&#25442;&#24186;&#21322;&#29615;&#19978;&#23450;&#20041;&#65292;
&#23427;&#30340;&#21462;&#20540;&#22312;&#25193;&#23637;&#33258;&#28982;&#25968; <code class="docutils literal notranslate"><span class="pre">enat</span></code> &#20013;&#65292;
&#21363;&#22312;&#33258;&#28982;&#25968;&#20013;&#28155;&#21152;&#26080;&#31351;&#20540;&#12290;
&#22312;&#19979;&#19968;&#31456;&#20013;&#65292;
&#25105;&#20204;&#23558;&#24320;&#22987;&#21457;&#23637;&#19968;&#20123;&#26041;&#27861;&#20174;&#32780;&#29702;&#35299; Lean &#25903;&#25345;&#36825;&#31867;&#19968;&#33324;&#24615;&#30340;&#36884;&#24452;&#12290;</p>
</section>
<section id="induction-and-recursion">
<span id="section-induction-and-recursion"></span><h2><span class="section-number">5.2. </span>Induction and Recursion<a class="headerlink" href="#induction-and-recursion" title="Link to this heading">&#61633;</a></h2>
<p>The set of natural numbers <span class="math notranslate nohighlight">\(\mathbb{N} = \{ 0, 1, 2, \ldots \}\)</span>
is not only fundamentally important in its own right,
but also a plays a central role in the construction of new mathematical objects.
Lean&#8217;s foundation allows us to declare <em>inductive types</em>,
which are types generated inductively by a given list of
<em>constructors</em>.
In Lean, the natural numbers are declared as follows.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">inductive</span> <span class="n">Nat</span>
  <span class="bp">|</span> <span class="n">zero</span> <span class="o">:</span> <span class="n">Nat</span>
  <span class="bp">|</span> <span class="n">succ</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span>
</pre></div>
</div>
<p>You can find this in the library by writing <code class="docutils literal notranslate"><span class="pre">#check</span> <span class="pre">Nat</span></code> and
then using <code class="docutils literal notranslate"><span class="pre">ctrl-click</span></code> on the identifier <code class="docutils literal notranslate"><span class="pre">Nat</span></code>.
The command specifies that <code class="docutils literal notranslate"><span class="pre">Nat</span></code> is the datatype generated
freely and inductively by the two constructors <code class="docutils literal notranslate"><span class="pre">zero</span> <span class="pre">:</span> <span class="pre">Nat</span></code> and
<code class="docutils literal notranslate"><span class="pre">succ</span> <span class="pre">:</span> <span class="pre">Nat</span> <span class="pre">&#8594;</span> <span class="pre">Nat</span></code>.
Of course, the library introduces notation <code class="docutils literal notranslate"><span class="pre">&#8469;</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span></code> for
<code class="docutils literal notranslate"><span class="pre">nat</span></code> and <code class="docutils literal notranslate"><span class="pre">zero</span></code> respectively. (Numerals are translated to binary
representations, but we don&#8217;t have to worry about the details of that now.)</p>
<p>What &#8220;freely&#8221; means for the working mathematician is that the type
<code class="docutils literal notranslate"><span class="pre">Nat</span></code> has an element <code class="docutils literal notranslate"><span class="pre">zero</span></code> and an injective successor function
<code class="docutils literal notranslate"><span class="pre">succ</span></code> whose image does not include <code class="docutils literal notranslate"><span class="pre">zero</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">n.succ</span> <span class="bp">&#8800;</span> <span class="n">Nat.zero</span> <span class="o">:=</span>
  <span class="n">Nat.succ_ne_zero</span> <span class="n">n</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m.succ</span> <span class="bp">=</span> <span class="n">n.succ</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
  <span class="n">Nat.succ.inj</span> <span class="n">h</span>
</pre></div>
</div>
<p>What the word &#8220;inductively&#8221; means for the working mathematician is that
the natural numbers comes with a principle of proof by induction
and a principle of definition by recursion.
This section will show you how to use these.</p>
<p>Here is an example of a recursive definition of the factorial
function.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">def</span> <span class="n">fac</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="n">&#8469;</span>
  <span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="mi">1</span>
  <span class="bp">|</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">fac</span> <span class="n">n</span>
</pre></div>
</div>
<p>The syntax takes some getting used to.
Notice that there is no <code class="docutils literal notranslate"><span class="pre">:=</span></code> on the first line.
The next two lines provide the base case and inductive step
for a recursive definition.
These equations hold definitionally, but they can also
be used manually by giving the name <code class="docutils literal notranslate"><span class="pre">fac</span></code> to <code class="docutils literal notranslate"><span class="pre">simp</span></code> or <code class="docutils literal notranslate"><span class="pre">rw</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">:</span> <span class="n">fac</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
  <span class="n">rfl</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">fac</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">fac</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="n">fac</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">fac</span> <span class="n">n</span> <span class="o">:=</span>
  <span class="n">rfl</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="n">fac</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">fac</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="n">fac</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">fac</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>
</pre></div>
</div>
<p>The factorial function is actually already defined in Mathlib as
<code class="docutils literal notranslate"><span class="pre">Nat.factorial</span></code>. Once again, you can jump to it by typing
<code class="docutils literal notranslate"><span class="pre">#check</span> <span class="pre">Nat.factorial</span></code> and using <code class="docutils literal notranslate"><span class="pre">ctrl-click.</span></code>
For illustrative purposes, we will continue using <code class="docutils literal notranslate"><span class="pre">fac</span></code> in the examples.
The annotation <code class="docutils literal notranslate"><span class="pre">&#64;[simp]</span></code> before the definition
of <code class="docutils literal notranslate"><span class="pre">Nat.factorial</span></code> specifies that
the defining equation should be added to the database of identities
that the simplifier uses by default.</p>
<p>The principle of induction says that we can prove a general statement
about the natural numbers by proving that the statement holds of 0
and that whenever it holds of a natural number <span class="math notranslate nohighlight">\(n\)</span>,
it also holds of <span class="math notranslate nohighlight">\(n + 1\)</span>.
The line <code class="docutils literal notranslate"><span class="pre">induction'</span> <span class="pre">n</span> <span class="pre">with</span> <span class="pre">n</span> <span class="pre">ih</span></code> in the proof
below therefore results in two goals:
in the first we need to prove <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">fac</span> <span class="pre">0</span></code>,
and in the second we have the added assumption <code class="docutils literal notranslate"><span class="pre">ih</span> <span class="pre">:</span> <span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">fac</span> <span class="pre">n</span></code>
and a required to prove <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">fac</span> <span class="pre">(n</span> <span class="pre">+</span> <span class="pre">1)</span></code>.
The phrase <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">n</span> <span class="pre">ih</span></code> serves to name the variable and
the assumption for the inductive hypothesis,
and you can choose whatever names you want for them.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">fac_pos</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">fac</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">rw</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>
    <span class="n">exact</span> <span class="n">zero_lt_one</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>
  <span class="n">exact</span> <span class="n">mul_pos</span> <span class="n">n.succ_pos</span> <span class="n">ih</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">induction</span></code> tactic is smart enough to include hypotheses
that depend on the induction variable as part of the
induction hypothesis.
Step through the next example to see what is going on.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">dvd_fac</span> <span class="o">{</span><span class="n">i</span> <span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">ipos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">ile</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&#8804;</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&#8739;</span> <span class="n">fac</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">exact</span> <span class="n">absurd</span> <span class="n">ipos</span> <span class="o">(</span><span class="n">not_lt_of_ge</span> <span class="n">ile</span><span class="o">)</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>
  <span class="n">rcases</span> <span class="n">Nat.of_le_succ</span> <span class="n">ile</span> <span class="k">with</span> <span class="n">h</span> <span class="bp">|</span> <span class="n">h</span>
  <span class="bp">&#183;</span> <span class="n">apply</span> <span class="n">dvd_mul_of_dvd_right</span> <span class="o">(</span><span class="n">ih</span> <span class="n">h</span><span class="o">)</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">]</span>
  <span class="n">apply</span> <span class="n">dvd_mul_right</span>
</pre></div>
</div>
<p>The following example provides a crude lower bound for the factorial
function.
It turns out to be easier to start with a proof by cases,
so that the remainder of the proof starts with the case
<span class="math notranslate nohighlight">\(n = 1\)</span>.
See if you can complete the argument with a proof by induction using <code class="docutils literal notranslate"><span class="pre">pow_succ</span></code>
or <code class="docutils literal notranslate"><span class="pre">pow_succ'</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">pow_two_le_fac</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">&#8804;</span> <span class="n">fac</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rcases</span> <span class="n">n</span> <span class="k">with</span> <span class="n">_</span> <span class="bp">|</span> <span class="n">n</span>
  <span class="bp">&#183;</span> <span class="n">simp</span> <span class="o">[</span><span class="n">fac</span><span class="o">]</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>Induction is often used to prove identities involving finite sums and
products.
Mathlib defines the expressions <code class="docutils literal notranslate"><span class="pre">Finset.sum</span> <span class="pre">s</span> <span class="pre">f</span></code> where
<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">:</span> <span class="pre">Finset</span> <span class="pre">&#945;</span></code> if a finite set of elements of the type <code class="docutils literal notranslate"><span class="pre">&#945;</span></code> and
<code class="docutils literal notranslate"><span class="pre">f</span></code> is a function defined on <code class="docutils literal notranslate"><span class="pre">&#945;</span></code>.
The codomain of <code class="docutils literal notranslate"><span class="pre">f</span></code> can be any type that supports a commutative,
associative addition operation with a zero element.
If you import <code class="docutils literal notranslate"><span class="pre">Algebra.BigOperators.Basic</span></code> and issue the command
<code class="docutils literal notranslate"><span class="pre">open</span> <span class="pre">BigOperators</span></code>, you can use the more suggestive notation
<code class="docutils literal notranslate"><span class="pre">&#8721;</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">s,</span> <span class="pre">f</span> <span class="pre">x</span></code>. Of course, there is are an analogous operation and
notation for finite products.</p>
<p>We will talk about the <code class="docutils literal notranslate"><span class="pre">Finset</span></code> type and the operations
it supports in the next section, and again in a later chapter.
For now, we will only make use
of <code class="docutils literal notranslate"><span class="pre">Finset.range</span> <span class="pre">n</span></code>, which is the finite set of natural numbers
less than <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variable</span> <span class="o">{</span><span class="n">&#945;</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span>

<span class="k">#check</span> <span class="n">Finset.sum</span> <span class="n">s</span> <span class="n">f</span>
<span class="k">#check</span> <span class="n">Finset.prod</span> <span class="n">s</span> <span class="n">f</span>

<span class="kn">open</span> <span class="n">BigOperators</span>
<span class="kn">open</span> <span class="n">Finset</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">s.sum</span> <span class="n">f</span> <span class="bp">=</span> <span class="bp">&#8721;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
  <span class="n">rfl</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">s.prod</span> <span class="n">f</span> <span class="bp">=</span> <span class="bp">&#8719;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
  <span class="n">rfl</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">range</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span> <span class="bp">=</span> <span class="bp">&#8721;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
  <span class="n">rfl</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">range</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">prod</span> <span class="n">f</span> <span class="bp">=</span> <span class="bp">&#8719;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
  <span class="n">rfl</span>
</pre></div>
</div>
<p>The facts <code class="docutils literal notranslate"><span class="pre">Finset.sum_range_zero</span></code> and <code class="docutils literal notranslate"><span class="pre">Finset.sum_range_succ</span></code>
provide a recursive description summation up to <span class="math notranslate nohighlight">\(n\)</span>,
and similarly for products.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8721;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="mi">0</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
  <span class="n">Finset.sum_range_zero</span> <span class="n">f</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8721;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n.succ</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">&#8721;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">n</span> <span class="o">:=</span>
  <span class="n">Finset.sum_range_succ</span> <span class="n">f</span> <span class="n">n</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8719;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="mi">0</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
  <span class="n">Finset.prod_range_zero</span> <span class="n">f</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8719;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n.succ</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">&#8719;</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">n</span> <span class="o">:=</span>
  <span class="n">Finset.prod_range_succ</span> <span class="n">f</span> <span class="n">n</span>
</pre></div>
</div>
<p>The first identity in each pair holds definitionally, which is to say,
you can replace the proofs by <code class="docutils literal notranslate"><span class="pre">rfl</span></code>.</p>
<p>The following expresses the factorial function that we defined as a product.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="n">fac</span> <span class="n">n</span> <span class="bp">=</span> <span class="bp">&#8719;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">rw</span> <span class="o">[</span><span class="n">fac</span><span class="o">,</span> <span class="n">prod_range_zero</span><span class="o">]</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fac</span><span class="o">,</span> <span class="n">ih</span><span class="o">,</span> <span class="n">prod_range_succ</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">]</span>
</pre></div>
</div>
<p>The fact that we include <code class="docutils literal notranslate"><span class="pre">mul_comm</span></code> as a simplification rule deserves
comment.
It should seem dangerous to simplify with the identity <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">*</span> <span class="pre">x</span></code>,
which would ordinarily loop indefinitely.
Lean&#8217;s simplifier is smart enough to recognize that, and applies the rule
only in the case where the resulting term has a smaller value in some
fixed but arbitrary ordering of the terms.
The following example shows that simplifying using the three rules
<code class="docutils literal notranslate"><span class="pre">mul_assoc</span></code>, <code class="docutils literal notranslate"><span class="pre">mul_comm</span></code>, and <code class="docutils literal notranslate"><span class="pre">mul_left_comm</span></code>
manages to identify products that are the same up to the
placement of parentheses and ordering of variables.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="n">e</span> <span class="n">f</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">f</span> <span class="bp">*</span> <span class="o">(</span><span class="n">d</span> <span class="bp">*</span> <span class="n">e</span><span class="o">))</span> <span class="bp">=</span> <span class="n">d</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">f</span> <span class="bp">*</span> <span class="n">e</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mul_assoc</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">,</span> <span class="n">mul_left_comm</span><span class="o">]</span>
</pre></div>
</div>
<p>Roughly, the rules work by pushing parentheses to the right
and then re-ordering the expressions on both sides until they
both follow the same canonical order. Simplifying with these
rules, and the corresponding rules for addition, is a handy trick.</p>
<p>Returning to summation identities, we suggest stepping through the following proof
that the sum of the natural numbers up to an including <span class="math notranslate nohighlight">\(n\)</span> is
<span class="math notranslate nohighlight">\(n (n + 1) / 2\)</span>.
The first step of the proof clears the denominator.
This is generally useful when formalizing identities,
because calculations with division generally have side conditions.
(It is similarly useful to avoid using subtraction on the natural numbers when possible.)</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">sum_id</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8721;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">symm</span><span class="bp">;</span> <span class="n">apply</span> <span class="n">Nat.div_eq_of_eq_mul_right</span> <span class="o">(</span><span class="kd">by</span> <span class="n">norm_num</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="mi">2</span><span class="o">)</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">simp</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">Finset.sum_range_succ</span><span class="o">,</span> <span class="n">mul_add</span> <span class="mi">2</span><span class="o">,</span> <span class="bp">&#8592;</span> <span class="n">ih</span><span class="o">]</span>
  <span class="n">ring</span>
</pre></div>
</div>
<p>We encourage you to prove the analogous identity for sums of squares,
and other identities you can find on the web.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">sum_sqr</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8721;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">i</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">6</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>In Lean&#8217;s core library, addition and multiplication are themselves defined
using recursive definitions,
and their fundamental properties are established using induction.
If you like thinking about foundational topics like that,
you might enjoy working through proofs
of the commutativity and associativity of multiplication and addition
and the distributivity of multiplication over addition.
You can do this on a copy of the natural numbers
following the outline below.
Notice that we can use the <code class="docutils literal notranslate"><span class="pre">induction</span></code> tactic with <code class="docutils literal notranslate"><span class="pre">MyNat</span></code>;
Lean is smart enough to know to
use the relevant induction principle (which is, of course,
the same as that for <code class="docutils literal notranslate"><span class="pre">Nat</span></code>).</p>
<p>We start you off with the commutativity of addition.
A good rule of thumb is that because addition and multiplication
are defined by recursion on the second argument,
it is generally advantageous to do proofs by induction on a variable
that occurs in that position.
It is a bit tricky to decide which variable to use in the proof
of associativity.</p>
<p>It can be confusing to write things without the usual notation
for zero, one, addition, and multiplication.
We will learn how to define such notation later.
Working in the namespace <code class="docutils literal notranslate"><span class="pre">MyNat</span></code> means that we can write
<code class="docutils literal notranslate"><span class="pre">zero</span></code> and <code class="docutils literal notranslate"><span class="pre">succ</span></code> rather than <code class="docutils literal notranslate"><span class="pre">MyNat.zero</span></code> and <code class="docutils literal notranslate"><span class="pre">MyNat.succ</span></code>,
and that these interpretations of the names take precedence over
others.
Outside the namespace, the full name of the <code class="docutils literal notranslate"><span class="pre">add</span></code> defined below,
for example, is <code class="docutils literal notranslate"><span class="pre">MyNat.add</span></code>.</p>
<p>If you find that you <em>really</em> enjoy this sort of thing, try defining
truncated subtraction and exponentiation and proving some of their
properties as well.
Remember that truncated subtraction cuts off at zero.
To define that, it is useful to define a predecessor function, <code class="docutils literal notranslate"><span class="pre">pred</span></code>,
that subtracts one from any nonzero number and fixes zero.
The function <code class="docutils literal notranslate"><span class="pre">pred</span></code> can be defined by a simple instance of recursion.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">inductive</span> <span class="n">MyNat</span>
  <span class="bp">|</span> <span class="n">zero</span> <span class="o">:</span> <span class="n">MyNat</span>
  <span class="bp">|</span> <span class="n">succ</span> <span class="o">:</span> <span class="n">MyNat</span> <span class="bp">&#8594;</span> <span class="n">MyNat</span>

<span class="kn">namespace</span> <span class="n">MyNat</span>

<span class="kd">def</span> <span class="n">add</span> <span class="o">:</span> <span class="n">MyNat</span> <span class="bp">&#8594;</span> <span class="n">MyNat</span> <span class="bp">&#8594;</span> <span class="n">MyNat</span>
  <span class="bp">|</span> <span class="n">x</span><span class="o">,</span> <span class="n">zero</span> <span class="bp">=&gt;</span> <span class="n">x</span>
  <span class="bp">|</span> <span class="n">x</span><span class="o">,</span> <span class="n">succ</span> <span class="n">y</span> <span class="bp">=&gt;</span> <span class="n">succ</span> <span class="o">(</span><span class="n">add</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">mul</span> <span class="o">:</span> <span class="n">MyNat</span> <span class="bp">&#8594;</span> <span class="n">MyNat</span> <span class="bp">&#8594;</span> <span class="n">MyNat</span>
  <span class="bp">|</span> <span class="n">x</span><span class="o">,</span> <span class="n">zero</span> <span class="bp">=&gt;</span> <span class="n">zero</span>
  <span class="bp">|</span> <span class="n">x</span><span class="o">,</span> <span class="n">succ</span> <span class="n">y</span> <span class="bp">=&gt;</span> <span class="n">add</span> <span class="o">(</span><span class="n">mul</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span>

<span class="kd">theorem</span> <span class="n">zero_add</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">add</span> <span class="n">zero</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">rfl</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">add</span><span class="o">,</span> <span class="n">ih</span><span class="o">]</span>

<span class="kd">theorem</span> <span class="n">succ_add</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">add</span> <span class="o">(</span><span class="n">succ</span> <span class="n">m</span><span class="o">)</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">add</span> <span class="n">m</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">rfl</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">add</span><span class="o">,</span> <span class="n">ih</span><span class="o">]</span>
  <span class="n">rfl</span>

<span class="kd">theorem</span> <span class="n">add_comm</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">add</span> <span class="n">m</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">add</span> <span class="n">n</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">rw</span> <span class="o">[</span><span class="n">zero_add</span><span class="o">]</span>
    <span class="n">rfl</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">add</span><span class="o">,</span> <span class="n">succ_add</span><span class="o">,</span> <span class="n">ih</span><span class="o">]</span>

<span class="kd">theorem</span> <span class="n">add_assoc</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">add</span> <span class="o">(</span><span class="n">add</span> <span class="n">m</span> <span class="n">n</span><span class="o">)</span> <span class="n">k</span> <span class="bp">=</span> <span class="n">add</span> <span class="n">m</span> <span class="o">(</span><span class="n">add</span> <span class="n">n</span> <span class="n">k</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
<span class="kd">theorem</span> <span class="n">mul_add</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">mul</span> <span class="n">m</span> <span class="o">(</span><span class="n">add</span> <span class="n">n</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="n">add</span> <span class="o">(</span><span class="n">mul</span> <span class="n">m</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">m</span> <span class="n">k</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
<span class="kd">theorem</span> <span class="n">zero_mul</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">mul</span> <span class="n">zero</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">zero</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
<span class="kd">theorem</span> <span class="n">succ_mul</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">mul</span> <span class="o">(</span><span class="n">succ</span> <span class="n">m</span><span class="o">)</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">add</span> <span class="o">(</span><span class="n">mul</span> <span class="n">m</span> <span class="n">n</span><span class="o">)</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
<span class="kd">theorem</span> <span class="n">mul_comm</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">MyNat</span><span class="o">)</span> <span class="o">:</span> <span class="n">mul</span> <span class="n">m</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">mul</span> <span class="n">n</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
<span class="kd">end</span> <span class="n">MyNat</span>
</pre></div>
</div>
</section>
<section id="infinitely-many-primes">
<span id="section-infinitely-many-primes"></span><h2><span class="section-number">5.3. </span>Infinitely Many Primes<a class="headerlink" href="#infinitely-many-primes" title="Link to this heading">&#61633;</a></h2>
<p>Let us continue our exploration of induction and recursion with another
mathematical standard: a proof that there are infinitely many primes.
One way to formulate this is as the statement that
for every natural number
<span class="math notranslate nohighlight">\(n\)</span>, there is a prime number greater than <span class="math notranslate nohighlight">\(n\)</span>.
To prove this, let <span class="math notranslate nohighlight">\(p\)</span> be any prime factor of <span class="math notranslate nohighlight">\(n! + 1\)</span>.
If <span class="math notranslate nohighlight">\(p\)</span> is less than <span class="math notranslate nohighlight">\(n\)</span>, it divides <span class="math notranslate nohighlight">\(n!\)</span>.
Since it also divides <span class="math notranslate nohighlight">\(n! + 1\)</span>, it divides 1, a contradiction.
Hence <span class="math notranslate nohighlight">\(p\)</span> is greater than <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>To formalize that proof, we need to show that any number greater than or equal
to 2 has a prime factor.
To do that, we will need to show that any natural number that is
not equal to 0 or 1 is greater-than or equal to 2.
And this brings us to a quirky feature of formalization:
it is often trivial statements like this that are among the most
annoying to formalize.
Here we consider a few ways to do it.</p>
<p>To start with, we can use the <code class="docutils literal notranslate"><span class="pre">cases</span></code> tactic and the fact that the
successor function respects the ordering on the natural numbers.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">two_le</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">cases</span> <span class="n">m</span><span class="bp">;</span> <span class="n">contradiction</span>
  <span class="n">case</span> <span class="n">succ</span> <span class="n">m</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">m</span><span class="bp">;</span> <span class="n">contradiction</span>
    <span class="n">repeat&#39;</span> <span class="n">apply</span> <span class="n">Nat.succ_le_succ</span>
    <span class="n">apply</span> <span class="n">zero_le</span>
</pre></div>
</div>
<p>Another strategy is to use the tactic <code class="docutils literal notranslate"><span class="pre">interval_cases</span></code>,
which automatically splits the goal into cases when
the variable in question is contained in an interval
of natural numbers or integers.
Remember that you can hover over it to see its documentation.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">by_contra</span> <span class="n">h</span>
  <span class="n">push_neg</span> <span class="n">at</span> <span class="n">h</span>
  <span class="n">interval_cases</span> <span class="n">m</span> <span class="bp">&lt;;&gt;</span> <span class="n">contradiction</span>
</pre></div>
</div>
<p id="index-0">Recall that the semicolon after <code class="docutils literal notranslate"><span class="pre">interval_cases</span> <span class="pre">m</span></code> means
that the next tactic is applied to each of the cases that it generates.
Yet another option is to use the tactic, <code class="docutils literal notranslate"><span class="pre">decide</span></code>, which tries
to find a decision procedure to solve the problem.
Lean knows that you can decide the truth value of a statement that
begins with a bounded quantifier <code class="docutils literal notranslate"><span class="pre">&#8704;</span> <span class="pre">x,</span> <span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">n</span> <span class="pre">&#8594;</span> <span class="pre">...</span></code> or <code class="docutils literal notranslate"><span class="pre">&#8707;</span> <span class="pre">x,</span> <span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">n</span> <span class="pre">&#8743;</span> <span class="pre">...</span></code>
by deciding each of the finitely many instances.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">by_contra</span> <span class="n">h</span>
  <span class="n">push_neg</span> <span class="n">at</span> <span class="n">h</span>
  <span class="n">revert</span> <span class="n">h0</span> <span class="n">h1</span>
  <span class="n">revert</span> <span class="n">h</span> <span class="n">m</span>
  <span class="n">decide</span>
</pre></div>
</div>
<p>With the theorem <code class="docutils literal notranslate"><span class="pre">two_le</span></code> in hand, let&#8217;s start by showing that every
natural number greater than two has a prime divisor.
Mathlib contains a function <code class="docutils literal notranslate"><span class="pre">Nat.minFac</span></code> that
returns the smallest prime divisor,
but for the sake of learning new parts of the library,
we&#8217;ll avoid using it and prove the theorem directly.</p>
<p>Here, ordinary induction isn&#8217;t enough.
We want to use <em>strong induction</em>, which allows us to prove
that every natural number <span class="math notranslate nohighlight">\(n\)</span> has a property <span class="math notranslate nohighlight">\(P\)</span>
by showing that for every number <span class="math notranslate nohighlight">\(n\)</span>, if <span class="math notranslate nohighlight">\(P\)</span> holds
of all values less than <span class="math notranslate nohighlight">\(n\)</span>, it holds at <span class="math notranslate nohighlight">\(n\)</span> as well.
In Lean, this principle is called <code class="docutils literal notranslate"><span class="pre">Nat.strong_induction_on</span></code>,
and we can use the <code class="docutils literal notranslate"><span class="pre">using</span></code> keyword to tell the induction tactic
to use it.
Notice that when we do that, there is no base case; it is subsumed
by the general induction step.</p>
<p>The argument is simply as follows. Assuming <span class="math notranslate nohighlight">\(n &#8805; 2\)</span>,
if <span class="math notranslate nohighlight">\(n\)</span> is prime, we&#8217;re done. If it isn&#8217;t,
then by one of the characterizations of what it means to be a prime number,
it has a nontrivial factor, <span class="math notranslate nohighlight">\(m\)</span>,
and we can apply the inductive hypothesis to that.
Step through the next proof to see how that plays out.
The line <code class="docutils literal notranslate"><span class="pre">dsimp</span> <span class="pre">at</span> <span class="pre">ih</span></code> simplifies the expression of the
inductive hypothesis to make it more readable.
The proof still works if you delete that line.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">exists_prime_factor</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="bp">&#8707;</span> <span class="n">p</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">,</span> <span class="n">p.Prime</span> <span class="bp">&#8743;</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">by_cases</span> <span class="n">np</span> <span class="o">:</span> <span class="n">n.Prime</span>
  <span class="bp">&#183;</span> <span class="n">use</span> <span class="n">n</span><span class="o">,</span> <span class="n">np</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="n">using</span> <span class="n">Nat.strong_induction_on</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.prime_def_lt</span><span class="o">]</span> <span class="n">at</span> <span class="n">np</span>
  <span class="n">push_neg</span> <span class="n">at</span> <span class="n">np</span>
  <span class="n">rcases</span> <span class="n">np</span> <span class="n">h</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">m</span><span class="o">,</span> <span class="n">mltn</span><span class="o">,</span> <span class="n">mdvdn</span><span class="o">,</span> <span class="n">mne1</span><span class="o">&#10217;</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="mi">0</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">intro</span> <span class="n">mz</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mz</span><span class="o">,</span> <span class="n">zero_dvd_iff</span><span class="o">]</span> <span class="n">at</span> <span class="n">mdvdn</span>
    <span class="n">linarith</span>
  <span class="k">have</span> <span class="n">mgt2</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">two_le</span> <span class="n">this</span> <span class="n">mne1</span>
  <span class="n">by_cases</span> <span class="n">mp</span> <span class="o">:</span> <span class="n">m.Prime</span>
  <span class="bp">&#183;</span> <span class="n">use</span> <span class="n">m</span><span class="o">,</span> <span class="n">mp</span>
  <span class="bp">.</span> <span class="n">rcases</span> <span class="n">ih</span> <span class="n">m</span> <span class="n">mltn</span> <span class="n">mgt2</span> <span class="n">mp</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">p</span><span class="o">,</span> <span class="n">pp</span><span class="o">,</span> <span class="n">pdvd</span><span class="o">&#10217;</span>
    <span class="n">use</span> <span class="n">p</span><span class="o">,</span> <span class="n">pp</span>
    <span class="n">apply</span> <span class="n">pdvd.trans</span> <span class="n">mdvdn</span>
</pre></div>
</div>
<p>We can now prove the following formulation of our theorem.
See if you can fill out the sketch.
You can use <code class="docutils literal notranslate"><span class="pre">Nat.factorial_pos</span></code>, <code class="docutils literal notranslate"><span class="pre">Nat.dvd_factorial</span></code>,
and <code class="docutils literal notranslate"><span class="pre">Nat.dvd_sub</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">primes_infinite</span> <span class="o">:</span> <span class="bp">&#8704;</span> <span class="n">n</span><span class="o">,</span> <span class="bp">&#8707;</span> <span class="n">p</span> <span class="bp">&gt;</span> <span class="n">n</span><span class="o">,</span> <span class="n">Nat.Prime</span> <span class="n">p</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">intro</span> <span class="n">n</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">Nat.factorial</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="n">rcases</span> <span class="n">exists_prime_factor</span> <span class="n">this</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">p</span><span class="o">,</span> <span class="n">pp</span><span class="o">,</span> <span class="n">pdvd</span><span class="o">&#10217;</span>
  <span class="n">refine&#39;</span> <span class="o">&#10216;</span><span class="n">p</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">pp</span><span class="o">&#10217;</span>
  <span class="k">show</span> <span class="n">p</span> <span class="bp">&gt;</span> <span class="n">n</span>
  <span class="n">by_contra</span> <span class="n">ple</span>
  <span class="n">push_neg</span>  <span class="n">at</span> <span class="n">ple</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="n">Nat.factorial</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">show</span> <span class="n">False</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>Let&#8217;s consider a variation of the proof above, where instead
of using the factorial function,
we suppose that we are given by a finite set
<span class="math notranslate nohighlight">\(\{ p_1, \ldots, p_n \}\)</span> and we consider a prime factor of
<span class="math notranslate nohighlight">\(\prod_{i = 1}^n p_i + 1\)</span>.
That prime factor has to be distinct from each
<span class="math notranslate nohighlight">\(p_i\)</span>, showing that there is no finite set that contains
all the prime numbers.</p>
<p>Formalizing this argument requires us to reason about finite
sets. In Lean, for any type <code class="docutils literal notranslate"><span class="pre">&#945;</span></code>, the type <code class="docutils literal notranslate"><span class="pre">Finset</span> <span class="pre">&#945;</span></code>
represents finite sets of elements of type <code class="docutils literal notranslate"><span class="pre">&#945;</span></code>.
Reasoning about finite sets computationally requires having
a procedure to test equality on <code class="docutils literal notranslate"><span class="pre">&#945;</span></code>, which is why the snippet
below includes the assumption <code class="docutils literal notranslate"><span class="pre">[DecidableEq</span> <span class="pre">&#945;]</span></code>.
For concrete data types like <code class="docutils literal notranslate"><span class="pre">&#8469;</span></code>, <code class="docutils literal notranslate"><span class="pre">&#8484;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&#8474;</span></code>,
the assumption is satisfied automatically. When reasoning about
the real numbers, it can be satisfied using classical logic
and abandoning the computational interpretation.</p>
<p>We use the command <code class="docutils literal notranslate"><span class="pre">open</span> <span class="pre">Finset</span></code> to avail ourselves of shorter names
for the relevant theorems. Unlike the case with sets,
most equivalences involving finsets do not hold definitionally,
so they need to be expanded manually using equivalences like
<code class="docutils literal notranslate"><span class="pre">Finset.subset_iff</span></code>, <code class="docutils literal notranslate"><span class="pre">Finset.mem_union</span></code>, <code class="docutils literal notranslate"><span class="pre">Finset.mem_inter</span></code>,
and <code class="docutils literal notranslate"><span class="pre">Finset.mem_sdiff</span></code>. The <code class="docutils literal notranslate"><span class="pre">ext</span></code> tactic can still be used
to reduce show that two finite sets are equal by showing
that every element of one is an element of the other.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">open</span> <span class="n">Finset</span>

<span class="kn">section</span>
<span class="kd">variable</span> <span class="o">{</span><span class="n">&#945;</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">DecidableEq</span> <span class="n">&#945;</span><span class="o">]</span> <span class="o">(</span><span class="n">r</span> <span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#945;</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="o">(</span><span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">t</span><span class="o">)</span> <span class="bp">&#8838;</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">t</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">subset_iff</span><span class="o">]</span>
  <span class="n">intro</span> <span class="n">x</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">mem_inter</span><span class="o">,</span> <span class="n">mem_union</span><span class="o">,</span> <span class="n">mem_union</span><span class="o">,</span> <span class="n">mem_inter</span><span class="o">,</span> <span class="n">mem_inter</span><span class="o">]</span>
  <span class="n">tauto</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="o">(</span><span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">t</span><span class="o">)</span> <span class="bp">&#8838;</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">t</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">subset_iff</span><span class="o">]</span>
  <span class="n">intro</span> <span class="n">x</span>
  <span class="n">tauto</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">t</span> <span class="bp">&#8838;</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="o">(</span><span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">t</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">subset_iff</span><span class="o">]</span>
  <span class="n">intro</span> <span class="n">x</span>
  <span class="n">tauto</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="n">t</span> <span class="bp">=</span> <span class="n">r</span> <span class="bp">&#8745;</span> <span class="o">(</span><span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">t</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">ext</span> <span class="n">x</span>
  <span class="n">simp</span>
  <span class="n">tauto</span>

<span class="kd">end</span>
</pre></div>
</div>
<p>We have used a new trick: the <code class="docutils literal notranslate"><span class="pre">tauto</span></code> tactic (and a strengthened
version, <code class="docutils literal notranslate"><span class="pre">tauto!</span></code>, which uses classical logic) can be used to
dispense with propositional tautologies. See if you can use
these methods to prove the two examples below.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">r</span> <span class="bp">&#8746;</span> <span class="n">s</span><span class="o">)</span> <span class="bp">&#8745;</span> <span class="o">(</span><span class="n">r</span> <span class="bp">&#8746;</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">r</span> <span class="bp">&#8746;</span> <span class="n">s</span> <span class="bp">&#8745;</span> <span class="n">t</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">r</span> <span class="bp">\</span> <span class="n">s</span><span class="o">)</span> <span class="bp">\</span> <span class="n">t</span> <span class="bp">=</span> <span class="n">r</span> <span class="bp">\</span> <span class="o">(</span><span class="n">s</span> <span class="bp">&#8746;</span> <span class="n">t</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>The theorem <code class="docutils literal notranslate"><span class="pre">Finset.dvd_prod_of_mem</span></code> tells us that if an
<code class="docutils literal notranslate"><span class="pre">n</span></code> is an element of a finite set <code class="docutils literal notranslate"><span class="pre">s</span></code>, then <code class="docutils literal notranslate"><span class="pre">n</span></code> divides
<code class="docutils literal notranslate"><span class="pre">&#8719;</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">s,</span> <span class="pre">i</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">&#8712;</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">&#8739;</span> <span class="bp">&#8719;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">i</span> <span class="o">:=</span>
  <span class="n">Finset.dvd_prod_of_mem</span> <span class="n">_</span> <span class="n">h</span>
</pre></div>
</div>
<p>We also need to know that the converse holds in the case where
<code class="docutils literal notranslate"><span class="pre">n</span></code> is prime and <code class="docutils literal notranslate"><span class="pre">s</span></code> is a set of primes.
To show that, we need the following lemma, which you should
be able to prove using the theorem <code class="docutils literal notranslate"><span class="pre">Nat.Prime.eq_one_or_self_of_dvd</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">_root_.Nat.Prime.eq_of_dvd_of_prime</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span>
      <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">Nat.Prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">prime_q</span> <span class="o">:</span> <span class="n">Nat.Prime</span> <span class="n">q</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">p</span> <span class="bp">=</span> <span class="n">q</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>We can use this lemma to show that if a prime <code class="docutils literal notranslate"><span class="pre">p</span></code> divides a product of a finite
set of primes, then it divides one of them.
Mathlib provides a useful principle of induction on finite sets:
to show that a property holds of an arbitrary finite set <code class="docutils literal notranslate"><span class="pre">s</span></code>,
show that it holds of the empty set, and show that it is preserved
when we add a single new element <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&#8713;</span> <span class="pre">s</span></code>.
The principle is known as <code class="docutils literal notranslate"><span class="pre">Finset.induction_on</span></code>.
When we tell the induction tactic to use it, we can also specify the names
<code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code>, the name for the assumption <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&#8713;</span> <span class="pre">s</span></code> in the inductive step,
and the name of the inductive hypothesis.
The expression <code class="docutils literal notranslate"><span class="pre">Finset.insert</span> <span class="pre">a</span> <span class="pre">s</span></code> denotes the union of <code class="docutils literal notranslate"><span class="pre">s</span></code> with the singleton <code class="docutils literal notranslate"><span class="pre">a</span></code>.
The identities <code class="docutils literal notranslate"><span class="pre">Finset.prod_empty</span></code> and <code class="docutils literal notranslate"><span class="pre">Finset.prod_insert</span></code> then provide
the relevant rewrite rules for the product.
In the proof below, the first <code class="docutils literal notranslate"><span class="pre">simp</span></code> applies <code class="docutils literal notranslate"><span class="pre">Finset.prod_empty</span></code>.
Step through the beginning of the proof to see the induction unfold,
and then finish it off.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">mem_of_dvd_prod_primes</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">prime_p</span> <span class="o">:</span> <span class="n">p.Prime</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">&#8704;</span> <span class="n">n</span> <span class="bp">&#8712;</span> <span class="n">s</span><span class="o">,</span> <span class="n">Nat.Prime</span> <span class="n">n</span><span class="o">)</span> <span class="bp">&#8594;</span> <span class="o">(</span><span class="n">p</span> <span class="bp">&#8739;</span> <span class="bp">&#8719;</span> <span class="n">n</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">n</span><span class="o">)</span> <span class="bp">&#8594;</span> <span class="n">p</span> <span class="bp">&#8712;</span> <span class="n">s</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">intro</span> <span class="n">h&#8320;</span> <span class="n">h&#8321;</span>
  <span class="n">induction&#39;</span> <span class="n">s</span> <span class="n">using</span> <span class="n">Finset.induction_on</span> <span class="k">with</span> <span class="n">a</span> <span class="n">s</span> <span class="n">ans</span> <span class="n">ih</span>
  <span class="bp">&#183;</span> <span class="n">simp</span> <span class="n">at</span> <span class="n">h&#8321;</span>
    <span class="n">linarith</span> <span class="o">[</span><span class="n">prime_p.two_le</span><span class="o">]</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">Finset.prod_insert</span> <span class="n">ans</span><span class="o">,</span> <span class="n">prime_p.dvd_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">h&#8320;</span> <span class="n">h&#8321;</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">mem_insert</span><span class="o">]</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>We need one last property of finite sets.
Given an element <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">:</span> <span class="pre">Set</span> <span class="pre">&#945;</span></code> and a predicate
<code class="docutils literal notranslate"><span class="pre">P</span></code> on <code class="docutils literal notranslate"><span class="pre">&#945;</span></code>, in  <a class="reference internal" href="C04_Sets_and_Functions.html#sets-and-functions"><span class="std std-numref">Chapter 4</span></a>
we wrote <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">x</span> <span class="pre">&#8712;</span> <span class="pre">s</span> <span class="pre">|</span> <span class="pre">P</span> <span class="pre">x</span> <span class="pre">}</span></code> for the set of
elements of <code class="docutils literal notranslate"><span class="pre">s</span></code> that satisfy <code class="docutils literal notranslate"><span class="pre">P</span></code>.
Given <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">:</span> <span class="pre">Finset</span> <span class="pre">&#945;</span></code>,
the analogous notion is written <code class="docutils literal notranslate"><span class="pre">s.filter</span> <span class="pre">P</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&#8712;</span> <span class="n">s.filter</span> <span class="n">Nat.Prime</span> <span class="bp">&#8596;</span> <span class="n">x</span> <span class="bp">&#8712;</span> <span class="n">s</span> <span class="bp">&#8743;</span> <span class="n">x.Prime</span> <span class="o">:=</span>
  <span class="n">mem_filter</span>
</pre></div>
</div>
<p>We now prove an alternative formulation of the statement that there are infinitely many
primes, namely, that given any <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">:</span> <span class="pre">Finset</span> <span class="pre">&#8469;</span></code>, there is a prime <code class="docutils literal notranslate"><span class="pre">p</span></code> that is not
an element of <code class="docutils literal notranslate"><span class="pre">s</span></code>.
Aiming for a contradiction, we assume that all the primes are in <code class="docutils literal notranslate"><span class="pre">s</span></code>, and then
cut down to a set <code class="docutils literal notranslate"><span class="pre">s'</span></code> that contains all and only the primes.
Taking the product of that set, adding one, and finding a prime factor
of the result
leads to the contradiction we are looking for.
See if you can complete the sketch below.
You can use <code class="docutils literal notranslate"><span class="pre">Finset.prod_pos</span></code> in the proof of the first <code class="docutils literal notranslate"><span class="pre">have</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">primes_infinite&#39;</span> <span class="o">:</span> <span class="bp">&#8704;</span> <span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">Nat</span><span class="o">,</span> <span class="bp">&#8707;</span> <span class="n">p</span><span class="o">,</span> <span class="n">Nat.Prime</span> <span class="n">p</span> <span class="bp">&#8743;</span> <span class="n">p</span> <span class="bp">&#8713;</span> <span class="n">s</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">intro</span> <span class="n">s</span>
  <span class="n">by_contra</span> <span class="n">h</span>
  <span class="n">push_neg</span>  <span class="n">at</span> <span class="n">h</span>
  <span class="n">set</span> <span class="n">s&#39;</span> <span class="o">:=</span> <span class="n">s.filter</span> <span class="n">Nat.Prime</span> <span class="k">with</span> <span class="n">s&#39;_def</span>
  <span class="k">have</span> <span class="n">mem_s&#39;</span> <span class="o">:</span> <span class="bp">&#8704;</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">},</span> <span class="n">n</span> <span class="bp">&#8712;</span> <span class="n">s&#39;</span> <span class="bp">&#8596;</span> <span class="n">n.Prime</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">intro</span> <span class="n">n</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">s&#39;_def</span><span class="o">]</span>
    <span class="n">apply</span> <span class="n">h</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="o">(</span><span class="bp">&#8719;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s&#39;</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="n">rcases</span> <span class="n">exists_prime_factor</span> <span class="n">this</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">p</span><span class="o">,</span> <span class="n">pp</span><span class="o">,</span> <span class="n">pdvd</span><span class="o">&#10217;</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="bp">&#8719;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s&#39;</span><span class="o">,</span> <span class="n">i</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">convert</span> <span class="n">Nat.dvd_sub&#39;</span> <span class="n">pdvd</span> <span class="n">this</span>
    <span class="n">simp</span>
  <span class="k">show</span> <span class="n">False</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>We have thus seen two ways of saying that there are infinitely many primes:
saying that they are not bounded by any <code class="docutils literal notranslate"><span class="pre">n</span></code>, and saying that they are
not contained in any finite set <code class="docutils literal notranslate"><span class="pre">s</span></code>.
The two proofs below show that these formulations are equivalent.
In the second, in order to form <code class="docutils literal notranslate"><span class="pre">s.filter</span> <span class="pre">Q</span></code>, we have to assume that there
is a procedure for deciding whether or not <code class="docutils literal notranslate"><span class="pre">Q</span></code> holds. Lean knows that there
is a procedure for <code class="docutils literal notranslate"><span class="pre">Nat.Prime</span></code>. In general, if we use classical logic
by writing <code class="docutils literal notranslate"><span class="pre">open</span> <span class="pre">Classical</span></code>,
we can dispense with the assumption.</p>
<p>In Mathlib, <code class="docutils literal notranslate"><span class="pre">Finset.sup</span> <span class="pre">s</span> <span class="pre">f</span></code> denotes the supremum of the values of <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">x</span></code> as <code class="docutils literal notranslate"><span class="pre">x</span></code>
ranges over <code class="docutils literal notranslate"><span class="pre">s</span></code>, returning <code class="docutils literal notranslate"><span class="pre">0</span></code> in the case where <code class="docutils literal notranslate"><span class="pre">s</span></code> is empty and
the codomain of <code class="docutils literal notranslate"><span class="pre">f</span></code> is <code class="docutils literal notranslate"><span class="pre">&#8469;</span></code>. In the first proof, we use <code class="docutils literal notranslate"><span class="pre">s.sup</span> <span class="pre">id</span></code>,
where <code class="docutils literal notranslate"><span class="pre">id</span></code> is the identity function, to refer to the maximum value in <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">bounded_of_ex_finset</span> <span class="o">(</span><span class="n">Q</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">&#8707;</span> <span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">,</span> <span class="bp">&#8704;</span> <span class="n">k</span><span class="o">,</span> <span class="n">Q</span> <span class="n">k</span> <span class="bp">&#8594;</span> <span class="n">k</span> <span class="bp">&#8712;</span> <span class="n">s</span><span class="o">)</span> <span class="bp">&#8594;</span> <span class="bp">&#8707;</span> <span class="n">n</span><span class="o">,</span> <span class="bp">&#8704;</span> <span class="n">k</span><span class="o">,</span> <span class="n">Q</span> <span class="n">k</span> <span class="bp">&#8594;</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rintro</span> <span class="o">&#10216;</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">&#10217;</span>
  <span class="n">use</span> <span class="n">s.sup</span> <span class="n">id</span> <span class="bp">+</span> <span class="mi">1</span>
  <span class="n">intro</span> <span class="n">k</span> <span class="n">Qk</span>
  <span class="n">apply</span> <span class="n">Nat.lt_succ_of_le</span>
  <span class="k">show</span> <span class="n">id</span> <span class="n">k</span> <span class="bp">&#8804;</span> <span class="n">s.sup</span> <span class="n">id</span>
  <span class="n">apply</span> <span class="n">le_sup</span> <span class="o">(</span><span class="n">hs</span> <span class="n">k</span> <span class="n">Qk</span><span class="o">)</span>

<span class="kd">theorem</span> <span class="n">ex_finset_of_bounded</span> <span class="o">(</span><span class="n">Q</span> <span class="o">:</span> <span class="n">&#8469;</span> <span class="bp">&#8594;</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">[</span><span class="n">DecidablePred</span> <span class="n">Q</span><span class="o">]</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">&#8707;</span> <span class="n">n</span><span class="o">,</span> <span class="bp">&#8704;</span> <span class="n">k</span><span class="o">,</span> <span class="n">Q</span> <span class="n">k</span> <span class="bp">&#8594;</span> <span class="n">k</span> <span class="bp">&#8804;</span> <span class="n">n</span><span class="o">)</span> <span class="bp">&#8594;</span> <span class="bp">&#8707;</span> <span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">,</span> <span class="bp">&#8704;</span> <span class="n">k</span><span class="o">,</span> <span class="n">Q</span> <span class="n">k</span> <span class="bp">&#8596;</span> <span class="n">k</span> <span class="bp">&#8712;</span> <span class="n">s</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rintro</span> <span class="o">&#10216;</span><span class="n">n</span><span class="o">,</span> <span class="n">hn</span><span class="o">&#10217;</span>
  <span class="n">use</span> <span class="o">(</span><span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">filter</span> <span class="n">Q</span>
  <span class="n">intro</span> <span class="n">k</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">Nat.lt_succ_iff</span><span class="o">]</span>
  <span class="n">exact</span> <span class="n">hn</span> <span class="n">k</span>
</pre></div>
</div>
<p>A small variation on our second proof that there are infinitely many primes
shows that there are infinitely many primes congruent to 3 modulo 4.
The argument goes as follows.
First, notice that if the product of two numbers <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(n\)</span>
is equal to 3 modulo 4, then one of the two numbers is congruent to three modulo 4.
After all, both have to be odd, and if they are both congruent to 1 modulo 4,
so is their product.
We can use this observation to show that if some number
greater than 2 is congruent to 3 modulo 4,
then that number has a prime divisor that is also congruent to 3 modulo 4.</p>
<p>Now suppose there are only finitely many prime numbers congruent to 3
modulo 4, say, <span class="math notranslate nohighlight">\(p_1, \ldots, p_k\)</span>.
Without loss of generality, we can assume that <span class="math notranslate nohighlight">\(p_1 = 3\)</span>.
Consider the product <span class="math notranslate nohighlight">\(4 \prod_{i = 2}^k p_i + 3\)</span>.
It is easy to see that this is congruent to 3 modulo 4, so it has
a prime factor <span class="math notranslate nohighlight">\(p\)</span> congruent to 3 modulo 4.
It can&#8217;t be the case that <span class="math notranslate nohighlight">\(p = 3\)</span>; since <span class="math notranslate nohighlight">\(p\)</span>
divides <span class="math notranslate nohighlight">\(4 \prod_{i = 2}^k p_i + 3\)</span>, if <span class="math notranslate nohighlight">\(p\)</span>
were equal to 3 then it would also divide <span class="math notranslate nohighlight">\(\prod_{i = 2}^k p_i\)</span>,
which implies that <span class="math notranslate nohighlight">\(p\)</span> is equal to
one of the <span class="math notranslate nohighlight">\(p_i\)</span> for <span class="math notranslate nohighlight">\(i = 2, \ldots, k\)</span>;
and we have excluded 3 from this list.
So <span class="math notranslate nohighlight">\(p\)</span> has to be one of the other elements <span class="math notranslate nohighlight">\(p_i\)</span>.
But in that case, <span class="math notranslate nohighlight">\(p\)</span> divides <span class="math notranslate nohighlight">\(4 \prod_{i = 2}^k p_i\)</span>
and hence 3, which contradicts the fact that it is not 3.</p>
<p>In Lean, the notation <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">%</span> <span class="pre">m</span></code>, read &#8220;<code class="docutils literal notranslate"><span class="pre">n</span></code> modulo <code class="docutils literal notranslate"><span class="pre">m</span></code>,&#8221;
denotes the remainder of the division of <code class="docutils literal notranslate"><span class="pre">n</span></code> by <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">:</span> <span class="mi">27</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>
</pre></div>
</div>
<p>We can then render the statement &#8220;<code class="docutils literal notranslate"><span class="pre">n</span></code> is congruent to 3 modulo 4&#8221;
as <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">%</span> <span class="pre">4</span> <span class="pre">=</span> <span class="pre">3</span></code>. The following example and theorems sum up
the facts about this function that we will need to use below.
The first named theorem is another illustration of reasoning by
a small number of cases.
In the second named theorem, remember that the semicolon means that
the subsequent tactic block is applied to all the goals created by the
preceding tactic.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">4</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">3</span><span class="o">)</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">add_comm</span><span class="o">,</span> <span class="n">Nat.add_mul_mod_self_left</span><span class="o">]</span>

<span class="kd">theorem</span> <span class="n">mod_4_eq_3_or_mod_4_eq_3</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">&#8744;</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">revert</span> <span class="n">h</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.mul_mod</span><span class="o">]</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">&lt;</span> <span class="mi">4</span> <span class="o">:=</span> <span class="n">Nat.mod_lt</span> <span class="n">m</span> <span class="o">(</span><span class="kd">by</span> <span class="n">norm_num</span><span class="o">)</span>
  <span class="n">interval_cases</span> <span class="n">m</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">&lt;;&gt;</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">-</span><span class="n">Nat.mul_mod_mod</span><span class="o">]</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">&lt;</span> <span class="mi">4</span> <span class="o">:=</span> <span class="n">Nat.mod_lt</span> <span class="n">n</span> <span class="o">(</span><span class="kd">by</span> <span class="n">norm_num</span><span class="o">)</span>
  <span class="n">interval_cases</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">&lt;;&gt;</span> <span class="n">simp</span>

<span class="kd">theorem</span> <span class="n">two_le_of_mod_4_eq_3</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">apply</span> <span class="n">two_le</span> <span class="bp">&lt;;&gt;</span>
    <span class="bp">&#183;</span> <span class="n">intro</span> <span class="n">neq</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">neq</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span>
      <span class="n">norm_num</span> <span class="n">at</span> <span class="n">h</span>
</pre></div>
</div>
<p>We will also need the following fact, which says that if
<code class="docutils literal notranslate"><span class="pre">m</span></code> is a nontrivial divisor of <code class="docutils literal notranslate"><span class="pre">n</span></code>, then so is <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">/</span> <span class="pre">m</span></code>.
See if you can complete the proof using <code class="docutils literal notranslate"><span class="pre">Nat.div_dvd_of_dvd</span></code>
and <code class="docutils literal notranslate"><span class="pre">Nat.div_lt_self</span></code>.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">aux</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">}</span> <span class="o">(</span><span class="n">h&#8320;</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8739;</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">h&#8321;</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">h&#8322;</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">m</span> <span class="bp">&#8739;</span> <span class="n">n</span> <span class="bp">&#8743;</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
</pre></div>
</div>
<p>Now put all the pieces together to prove that any
number congruent to 3 modulo 4 has a prime divisor with that
same property.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">exists_prime_factor_mod_4_eq_3</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">&#8707;</span> <span class="n">p</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">,</span> <span class="n">p.Prime</span> <span class="bp">&#8743;</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="n">n</span> <span class="bp">&#8743;</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">by_cases</span> <span class="n">np</span> <span class="o">:</span> <span class="n">n.Prime</span>
  <span class="bp">&#183;</span> <span class="n">use</span> <span class="n">n</span>
  <span class="n">induction&#39;</span> <span class="n">n</span> <span class="n">using</span> <span class="n">Nat.strong_induction_on</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.prime_def_lt</span><span class="o">]</span> <span class="n">at</span> <span class="n">np</span>
  <span class="n">push_neg</span>  <span class="n">at</span> <span class="n">np</span>
  <span class="n">rcases</span> <span class="n">np</span> <span class="o">(</span><span class="n">two_le_of_mod_4_eq_3</span> <span class="n">h</span><span class="o">)</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">m</span><span class="o">,</span> <span class="n">mltn</span><span class="o">,</span> <span class="n">mdvdn</span><span class="o">,</span> <span class="n">mne1</span><span class="o">&#10217;</span>
  <span class="k">have</span> <span class="n">mge2</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&#8804;</span> <span class="n">m</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">apply</span> <span class="n">two_le</span> <span class="n">_</span> <span class="n">mne1</span>
    <span class="n">intro</span> <span class="n">mz</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mz</span><span class="o">,</span> <span class="n">zero_dvd_iff</span><span class="o">]</span> <span class="n">at</span> <span class="n">mdvdn</span>
    <span class="n">linarith</span>
  <span class="k">have</span> <span class="n">neq</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">/</span> <span class="n">m</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">Nat.mul_div_cancel&#39;</span> <span class="n">mdvdn</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">&#8744;</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">m</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">apply</span> <span class="n">mod_4_eq_3_or_mod_4_eq_3</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">neq</span><span class="o">,</span> <span class="n">h</span><span class="o">]</span>
  <span class="n">rcases</span> <span class="n">this</span> <span class="k">with</span> <span class="n">h1</span> <span class="bp">|</span> <span class="n">h1</span>
  <span class="bp">.</span> <span class="gr">sorry</span>
  <span class="bp">.</span> <span class="gr">sorry</span>
</pre></div>
</div>
<p>We are in the home stretch. Given a set <code class="docutils literal notranslate"><span class="pre">s</span></code> of prime
numbers, we need to talk about the result of removing 3 from that
set, if it is present. The function <code class="docutils literal notranslate"><span class="pre">Finset.erase</span></code> handles that.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8712;</span> <span class="n">erase</span> <span class="n">s</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="n">n</span> <span class="bp">&#8743;</span> <span class="n">m</span> <span class="bp">&#8712;</span> <span class="n">s</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">rwa</span> <span class="o">[</span><span class="n">mem_erase</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">&#8469;</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8712;</span> <span class="n">erase</span> <span class="n">s</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&#8800;</span> <span class="n">n</span> <span class="bp">&#8743;</span> <span class="n">m</span> <span class="bp">&#8712;</span> <span class="n">s</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span>
  <span class="n">assumption</span>
</pre></div>
</div>
<p>We are now ready to prove that there are infinitely many primes
congruent to 3 modulo 4.
Fill in the missing parts below.
Our solution uses <code class="docutils literal notranslate"><span class="pre">Nat.dvd_add_iff_left</span></code> and <code class="docutils literal notranslate"><span class="pre">Nat.dvd_sub'</span></code>
along the way.</p>
<div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span> <span class="n">primes_mod_4_eq_3_infinite</span> <span class="o">:</span> <span class="bp">&#8704;</span> <span class="n">n</span><span class="o">,</span> <span class="bp">&#8707;</span> <span class="n">p</span> <span class="bp">&gt;</span> <span class="n">n</span><span class="o">,</span> <span class="n">Nat.Prime</span> <span class="n">p</span> <span class="bp">&#8743;</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">by_contra</span> <span class="n">h</span>
  <span class="n">push_neg</span>  <span class="n">at</span> <span class="n">h</span>
  <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">n</span><span class="o">,</span> <span class="n">hn</span><span class="o">&#10217;</span>
  <span class="k">have</span> <span class="o">:</span> <span class="bp">&#8707;</span> <span class="n">s</span> <span class="o">:</span> <span class="n">Finset</span> <span class="n">Nat</span><span class="o">,</span> <span class="bp">&#8704;</span> <span class="n">p</span> <span class="o">:</span> <span class="n">&#8469;</span><span class="o">,</span> <span class="n">p.Prime</span> <span class="bp">&#8743;</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">&#8596;</span> <span class="n">p</span> <span class="bp">&#8712;</span> <span class="n">s</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">apply</span> <span class="n">ex_finset_of_bounded</span>
    <span class="n">use</span> <span class="n">n</span>
    <span class="n">contrapose</span><span class="bp">!</span> <span class="n">hn</span>
    <span class="n">rcases</span> <span class="n">hn</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">p</span><span class="o">,</span> <span class="o">&#10216;</span><span class="n">pp</span><span class="o">,</span> <span class="n">p4</span><span class="o">&#10217;,</span> <span class="n">pltn</span><span class="o">&#10217;</span>
    <span class="n">exact</span> <span class="o">&#10216;</span><span class="n">p</span><span class="o">,</span> <span class="n">pltn</span><span class="o">,</span> <span class="n">pp</span><span class="o">,</span> <span class="n">p4</span><span class="o">&#10217;</span>
  <span class="n">rcases</span> <span class="n">this</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">&#10217;</span>
  <span class="k">have</span> <span class="n">h&#8321;</span> <span class="o">:</span> <span class="o">((</span><span class="mi">4</span> <span class="bp">*</span> <span class="bp">&#8719;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">erase</span> <span class="n">s</span> <span class="mi">3</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">3</span><span class="o">)</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="n">rcases</span> <span class="n">exists_prime_factor_mod_4_eq_3</span> <span class="n">h&#8321;</span> <span class="k">with</span> <span class="o">&#10216;</span><span class="n">p</span><span class="o">,</span> <span class="n">pp</span><span class="o">,</span> <span class="n">pdvd</span><span class="o">,</span> <span class="n">p4eq</span><span class="o">&#10217;</span>
  <span class="k">have</span> <span class="n">ps</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8712;</span> <span class="n">s</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="n">pne3</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8800;</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="mi">4</span> <span class="bp">*</span> <span class="bp">&#8719;</span> <span class="n">i</span> <span class="k">in</span> <span class="n">erase</span> <span class="n">s</span> <span class="mi">3</span><span class="o">,</span> <span class="n">i</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">&#8739;</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="gr">sorry</span>
  <span class="n">contradiction</span>
</pre></div>
</div>
<p>If you managed to complete the proof, congratulations! This has been a serious
feat of formalization.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="C04_Sets_and_Functions.html" class="btn btn-neutral float-left" title="4. &#38598;&#21512;&#21644;&#20989;&#25968;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="C06_Structures.html" class="btn btn-neutral float-right" title="6. Structures" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Jeremy Avigad, Patrick Massot.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>